<!doctype html>
<html lang="es">
 <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Procedimiento de Gesti√≥n de Inversiones Patrimoniales</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <!-- Librer√≠a para generar PDF -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&amp;display=swap" rel="stylesheet">
  <style>
        @font-face {
            font-family: 'Tw Cen MT';
            src: local('Tw Cen MT'), local('TwCenMT');
            font-weight: normal;
            font-style: normal;
        }
    </style>
  <style>
        body {
            box-sizing: border-box;
        }
        
        :root {
            --color-primary: #006C72;
            --color-secondary: #CCD400;
            --color-medium: #004651;
            --color-light: #f5f5f5;
        }
        
        html, body {
            height: 100%;
            margin: 0;
            padding: 0;
        }
        
        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--color-light);
            color: var(--color-primary);
        }
        
        .step-card {
            transition: transform 0.3s, box-shadow 0.3s;
            border-left: 6px solid var(--color-medium);
        }
        
        .step-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
        }
        
        .step-number {
            background: linear-gradient(135deg, var(--color-primary), var(--color-medium));
            width: 48px;
            height: 48px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 800;
            font-size: 1.25rem;
            color: white;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        
        .objective-item {
            transition: all 0.3s;
            border-left: 4px solid var(--color-secondary);
        }
        
        .objective-item:hover {
            background-color: white;
            border-left-width: 6px;
            padding-left: 1.25rem;
        }
        
        .icon-circle {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--color-secondary), #b8c000);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.25rem;
            flex-shrink: 0;
        }
    </style>
  <style>@view-transition { navigation: auto; }</style>
 </head>
 <body>
  <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: 'var(--color-primary)',
                        secondary: 'var(--color-secondary)',
                        medium: 'var(--color-medium)',
                        background_light: 'var(--color-light)',
                    }
                }
            }
        }
    </script>
  <div class="min-h-full p-4 md:p-10"><!-- HEADER AND METADATA -->
   <header class="bg-white p-6 rounded-xl shadow-2xl mb-8 border-b-8 border-medium">
    
    <!-- Contenedor Flex Principal: Logo/T√≠tulo a la izquierda, Acciones a la derecha -->
    <div class="flex flex-col xl:flex-row items-center justify-between gap-6">
        
        <!-- Secci√≥n Izquierda: Logo y Textos -->
        <div class="flex flex-col md:flex-row items-center gap-6 w-full xl:w-auto text-center md:text-left">
            <!-- Logo Box -->
            <div class="rounded-lg shadow-sm flex items-center justify-center flex-shrink-0 bg-white px-2 py-1 border border-gray-100" style="height: 60px; width: auto;">
                <svg viewbox="0 0 240 80" style="height: 100%; width: auto;" xmlns="http://www.w3.org/2000/svg" preserveAspectRatio="xMidYMid meet">
                    <text x="10" y="55" font-family="Arial, Helvetica, sans-serif" font-size="48" font-weight="900" letter-spacing="-2">
                        <tspan fill="#CCD400">Infi</tspan>
                        <tspan fill="#006C72" dx="-2">Huila</tspan>
                    </text>
                </svg>
            </div>
            
            <!-- T√≠tulos -->
            <div class="flex-1">
                <h1 id="main-title" class="text-xl md:text-2xl font-extrabold text-primary leading-tight uppercase">PROCEDIMIENTO DE GESTI√ìN DE<br class="hidden lg:block"/> INVERSIONES PATRIMONIALES</h1>
                <p id="subtitle" class="text-sm text-medium font-bold mt-1 md:border-l-4 md:border-secondary md:pl-3">INFIHUILA | Proceso: Gesti√≥n Financiera</p>
            </div>
        </div>

        <!-- Secci√≥n Derecha: Bot√≥n PDF y Metadatos alineados -->
        <!-- Ajuste: flex-row para mantenerlos en l√≠nea, items-stretch para misma altura visual si es necesario, o items-center -->
        <div class="flex flex-col md:flex-row items-center gap-3 w-full xl:w-auto justify-center xl:justify-end">
            <!-- Bot√≥n PDF (M√°s peque√±o y compacto) -->
            <button id="header-pdf-btn" data-html2canvas-ignore="true" class="px-4 py-2 rounded-lg font-bold text-sm shadow-md transition-all hover:shadow-lg hover:-translate-y-0.5 active:scale-95 flex items-center gap-2 whitespace-nowrap" style="background-color: var(--color-secondary); color: var(--color-primary);">
                <svg class="w-4 h-4" fill="none" stroke="currentColor" stroke-width="2.5" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4" />
                </svg>
                Descargar PDF
            </button>

            <!-- Metadata Card (Alineada y compacta) -->
            <div class="bg-primary text-white p-2 px-4 rounded-lg border border-secondary shadow-md text-xs min-w-[150px]">
                <div class="grid grid-cols-[auto_1fr] gap-x-3 gap-y-0.5 items-center">
                    <span class="text-secondary font-bold text-right">C√≥digo:</span>
                    <span id="code-value" class="font-mono tracking-wide">PI-XX</span>
                    
                    <span class="text-secondary font-bold text-right">Versi√≥n:</span>
                    <span id="version-value">01</span>
                    
                    <span class="text-secondary font-bold text-right">Vigencia:</span>
                    <span id="validity-value">2025</span>
                </div>
            </div>
        </div>

    </div>

    <!-- Footer del Header (MIPG) -->
    <div class="mt-6 pt-4 border-t border-gray-200 text-xs text-center sm:text-left flex flex-col sm:flex-row gap-2">
        <span class="font-bold text-primary whitespace-nowrap">Articulaci√≥n MIPG:</span> 
        <span class="text-gray-600 font-medium">Gesti√≥n con Valores, Planeaci√≥n Institucional, Gesti√≥n Presupuestal, Control Interno, Transparencia.</span>
    </div>

   </header><!-- MAIN CONTENT GRID -->
   <main class="grid grid-cols-1 lg:grid-cols-3 gap-8"><!-- COLUMN 1 & 2: 6-STEP PROCEDURE FLOW -->
    <section class="lg:col-span-2 space-y-6">
     <h2 id="phases-title" class="text-2xl font-bold text-primary border-b-2 border-secondary pb-2">6 FASES CLAVE</h2>
     <div class="space-y-4 sm:space-y-6"><!-- Step 1: IDENTIFICACI√ìN -->
      <div class="step-card bg-white p-4 sm:p-6 rounded-xl shadow-lg">
       <div class="flex flex-col sm:flex-row items-start gap-3 sm:gap-4">
        <div class="step-number">
         1
        </div>
        <div class="flex-1">
         <h3 class="text-lg sm:text-xl font-bold text-primary mb-2">IDENTIFICACI√ìN DE LA NECESIDAD</h3>
         <p class="text-sm sm:text-base text-gray-700 mb-3">Detectar oportunidades de inversi√≥n alineadas con el plan estrat√©gico institucional.</p>
         <div class="bg-background_light p-3 rounded-lg text-sm">
          <p class="font-semibold text-medium mb-1">√Årea Responsable:</p>
          <p class="text-gray-700">Direcci√≥n Financiera / Comit√© de Inversiones</p>
         </div>
        </div>
       </div>
      </div><!-- Step 2: AN√ÅLISIS -->
      <div class="step-card bg-white p-4 sm:p-6 rounded-xl shadow-lg">
       <div class="flex flex-col sm:flex-row items-start gap-3 sm:gap-4">
        <div class="step-number">
         2
        </div>
        <div class="flex-1">
         <h3 class="text-lg sm:text-xl font-bold text-primary mb-2">AN√ÅLISIS Y EVALUACI√ìN</h3>
         <p class="text-sm sm:text-base text-gray-700 mb-3">Estudio t√©cnico, financiero y de riesgo de las alternativas de inversi√≥n identificadas.</p>
         <div class="grid grid-cols-1 sm:grid-cols-2 gap-2 mt-3">
          <div class="bg-background_light p-2 rounded text-xs sm:text-sm flex items-center gap-2">
           <svg class="w-4 h-4 sm:w-5 sm:h-5 flex-shrink-0" fill="none" stroke="currentColor" stroke-width="2" viewbox="0 0 24 24" style="color: var(--color-secondary)"><path stroke-linecap="round" stroke-linejoin="round" d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
           </svg><span class="font-semibold">Rentabilidad esperada</span>
          </div>
          <div class="bg-background_light p-2 rounded text-xs sm:text-sm flex items-center gap-2">
           <svg class="w-4 h-4 sm:w-5 sm:h-5 flex-shrink-0" fill="none" stroke="currentColor" stroke-width="2" viewbox="0 0 24 24" style="color: var(--color-medium)"><path stroke-linecap="round" stroke-linejoin="round" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z" />
           </svg><span class="font-semibold">An√°lisis de riesgo</span>
          </div>
          <div class="bg-background_light p-2 rounded text-xs sm:text-sm flex items-center gap-2">
           <svg class="w-4 h-4 sm:w-5 sm:h-5 flex-shrink-0" fill="none" stroke="currentColor" stroke-width="2" viewbox="0 0 24 24" style="color: var(--color-primary)"><path stroke-linecap="round" stroke-linejoin="round" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
           </svg><span class="font-semibold">Marco normativo</span>
          </div>
          <div class="bg-background_light p-2 rounded text-xs sm:text-sm flex items-center gap-2">
           <svg class="w-4 h-4 sm:w-5 sm:h-5 flex-shrink-0" fill="none" stroke="currentColor" stroke-width="2" viewbox="0 0 24 24" style="color: var(--color-secondary)"><path stroke-linecap="round" stroke-linejoin="round" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z" />
           </svg><span class="font-semibold">Impacto institucional</span>
          </div>
         </div>
        </div>
       </div>
      </div><!-- Step 3: APROBACI√ìN -->
      <div class="step-card bg-white p-4 sm:p-6 rounded-xl shadow-lg">
       <div class="flex flex-col sm:flex-row items-start gap-3 sm:gap-4">
        <div class="step-number">
         3
        </div>
        <div class="flex-1">
         <h3 class="text-lg sm:text-xl font-bold text-primary mb-2">APROBACI√ìN Y PRESUPUESTO</h3>
         <p class="text-sm sm:text-base text-gray-700 mb-3">Presentaci√≥n al √≥rgano competente para decisi√≥n y asignaci√≥n presupuestal.</p>
         <div class="bg-background_light p-3 rounded-lg text-xs sm:text-sm flex items-start gap-2 sm:gap-3">
          <svg class="w-5 h-5 sm:w-6 sm:h-6 flex-shrink-0 mt-0.5" fill="none" stroke="currentColor" stroke-width="2" viewbox="0 0 24 24" style="color: var(--color-secondary)"><path stroke-linecap="round" stroke-linejoin="round" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
          </svg>
          <div>
           <p class="font-semibold text-medium mb-1">Documentos requeridos:</p>
           <p class="text-gray-700">Informe t√©cnico, proyecciones financieras, acta de comit√©, certificado de disponibilidad presupuestal.</p>
          </div>
         </div>
        </div>
       </div>
      </div><!-- Step 4: EJECUCI√ìN -->
      <div class="step-card bg-white p-4 sm:p-6 rounded-xl shadow-lg">
       <div class="flex flex-col sm:flex-row items-start gap-3 sm:gap-4">
        <div class="step-number">
         4
        </div>
        <div class="flex-1">
         <h3 class="text-lg sm:text-xl font-bold text-primary mb-2">EJECUCI√ìN DE LA INVERSI√ìN</h3>
         <p class="text-sm sm:text-base text-gray-700 mb-3">Formalizaci√≥n y desembolso conforme a procedimientos contractuales y financieros establecidos.</p>
         <div class="bg-background_light p-3 rounded-lg text-xs sm:text-sm flex items-start gap-2 sm:gap-3">
          <svg class="w-5 h-5 sm:w-6 sm:h-6 flex-shrink-0 mt-0.5" fill="none" stroke="currentColor" stroke-width="2" viewbox="0 0 24 24" style="color: var(--color-primary)"><path stroke-linecap="round" stroke-linejoin="round" d="M17 9V7a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2m2 4h10a2 2 0 002-2v-6a2 2 0 00-2-2H9a2 2 0 00-2 2v6a2 2 0 002 2zm7-5a2 2 0 11-4 0 2 2 0 014 0z" />
          </svg>
          <p class="text-gray-700">Registro contable, seguimiento a plazos, custodia de soportes, actualizaci√≥n del portafolio.</p>
         </div>
        </div>
       </div>
      </div><!-- Step 5: SEGUIMIENTO -->
      <div class="step-card bg-white p-4 sm:p-6 rounded-xl shadow-lg">
       <div class="flex flex-col sm:flex-row items-start gap-3 sm:gap-4">
        <div class="step-number">
         5
        </div>
        <div class="flex-1">
         <h3 class="text-lg sm:text-xl font-bold text-primary mb-2">SEGUIMIENTO Y MONITOREO</h3>
         <p class="text-sm sm:text-base text-gray-700 mb-3">Evaluaci√≥n peri√≥dica del rendimiento, liquidez, y cumplimiento de metas establecidas.</p>
         <div class="flex flex-wrap gap-2 mt-3"><span class="bg-secondary text-primary px-2 sm:px-3 py-1 rounded-full text-xs sm:text-sm font-semibold flex items-center gap-1 sm:gap-2">
           <svg class="w-3 h-3 sm:w-4 sm:h-4" fill="none" stroke="currentColor" stroke-width="2" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M9 17v-2m3 2v-4m3 4v-6m2 10H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
           </svg> Reportes mensuales </span> <span class="bg-secondary text-primary px-2 sm:px-3 py-1 rounded-full text-xs sm:text-sm font-semibold flex items-center gap-1 sm:gap-2">
           <svg class="w-3 h-3 sm:w-4 sm:h-4" fill="none" stroke="currentColor" stroke-width="2" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M13 7h8m0 0v8m0-8l-8 8-4-4-6 6" />
           </svg> Indicadores KPI </span> <span class="bg-secondary text-primary px-2 sm:px-3 py-1 rounded-full text-xs sm:text-sm font-semibold flex items-center gap-1 sm:gap-2">
           <svg class="w-3 h-3 sm:w-4 sm:h-4" fill="none" stroke="currentColor" stroke-width="2" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9" />
           </svg> Alertas tempranas </span>
         </div>
        </div>
       </div>
      </div><!-- Step 6: CIERRE -->
      <div class="step-card bg-white p-4 sm:p-6 rounded-xl shadow-lg">
       <div class="flex flex-col sm:flex-row items-start gap-3 sm:gap-4">
        <div class="step-number">
         6
        </div>
        <div class="flex-1">
         <h3 class="text-lg sm:text-xl font-bold text-primary mb-2">CIERRE Y EVALUACI√ìN FINAL</h3>
         <p class="text-sm sm:text-base text-gray-700 mb-3">Liquidaci√≥n de la inversi√≥n y an√°lisis de resultados obtenidos.</p>
         <div class="bg-gradient-to-r from-primary to-medium text-white p-3 rounded-lg text-xs sm:text-sm flex items-start gap-2 sm:gap-3">
          <svg class="w-5 h-5 sm:w-6 sm:h-6 flex-shrink-0 mt-0.5" fill="none" stroke="currentColor" stroke-width="2" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4" />
          </svg>
          <div>
           <p class="font-semibold">Resultado esperado:</p>
           <p>Informe de cierre con an√°lisis de rentabilidad real vs proyectada y recomendaciones para futuras inversiones.</p>
          </div>
         </div>
        </div>
       </div>
      </div>
     </div>
    </section><!-- COLUMN 3: SUPPORTING INFORMATION -->
    <aside class="space-y-6">
     <h2 id="objectives-title" class="text-2xl font-bold text-primary border-b-2 border-secondary pb-2">OBJETIVOS Y ALCANCE</h2><!-- Objectives -->
     <div class="bg-white p-6 rounded-xl shadow-lg">
      <h3 class="text-lg font-bold text-primary mb-4 flex items-center gap-2">
       <svg class="w-7 h-7" fill="none" stroke="currentColor" stroke-width="2" viewbox="0 0 24 24" style="color: var(--color-secondary)"><path stroke-linecap="round" stroke-linejoin="round" d="M9 12l2 2 4-4M7.835 4.697a3.42 3.42 0 001.946-.806 3.42 3.42 0 014.438 0 3.42 3.42 0 001.946.806 3.42 3.42 0 013.138 3.138 3.42 3.42 0 00.806 1.946 3.42 3.42 0 010 4.438 3.42 3.42 0 00-.806 1.946 3.42 3.42 0 01-3.138 3.138 3.42 3.42 0 00-1.946.806 3.42 3.42 0 01-4.438 0 3.42 3.42 0 00-1.946-.806 3.42 3.42 0 01-3.138-3.138 3.42 3.42 0 00-.806-1.946 3.42 3.42 0 010-4.438 3.42 3.42 0 00.806-1.946 3.42 3.42 0 013.138-3.138z" />
       </svg> Objetivos Principales</h3>
      <div class="space-y-3">
       <div class="objective-item bg-background_light p-3 rounded-lg transition-all flex items-start gap-3">
        <svg class="w-5 h-5 flex-shrink-0 mt-0.5" fill="none" stroke="currentColor" stroke-width="2" viewbox="0 0 24 24" style="color: var(--color-secondary)"><path stroke-linecap="round" stroke-linejoin="round" d="M13 7h8m0 0v8m0-8l-8 8-4-4-6 6" />
        </svg>
        <div>
         <p class="text-sm font-semibold text-primary">Maximizar rendimientos</p>
         <p class="text-xs text-gray-600 mt-1">Optimizar el retorno sobre las inversiones institucionales</p>
        </div>
       </div>
       <div class="objective-item bg-background_light p-3 rounded-lg transition-all flex items-start gap-3">
        <svg class="w-5 h-5 flex-shrink-0 mt-0.5" fill="none" stroke="currentColor" stroke-width="2" viewbox="0 0 24 24" style="color: var(--color-medium)"><path stroke-linecap="round" stroke-linejoin="round" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z" />
        </svg>
        <div>
         <p class="text-sm font-semibold text-primary">Gesti√≥n de riesgos</p>
         <p class="text-xs text-gray-600 mt-1">Minimizar exposici√≥n a riesgos financieros y operativos</p>
        </div>
       </div>
       <div class="objective-item bg-background_light p-3 rounded-lg transition-all flex items-start gap-3">
        <svg class="w-5 h-5 flex-shrink-0 mt-0.5" fill="none" stroke="currentColor" stroke-width="2" viewbox="0 0 24 24" style="color: var(--color-primary)"><path stroke-linecap="round" stroke-linejoin="round" d="M10 6H5a2 2 0 00-2 2v9a2 2 0 002 2h14a2 2 0 002-2V8a2 2 0 00-2-2h-5m-4 0V5a2 2 0 114 0v1m-4 0a2 2 0 104 0m-5 8a2 2 0 100-4 2 2 0 000 4zm0 0c1.306 0 2.417.835 2.83 2M9 14a3.001 3.001 0 00-2.83 2M15 11h3m-3 4h2" />
        </svg>
        <div>
         <p class="text-sm font-semibold text-primary">Cumplimiento normativo</p>
         <p class="text-xs text-gray-600 mt-1">Garantizar adherencia a regulaciones vigentes</p>
        </div>
       </div>
       <div class="objective-item bg-background_light p-3 rounded-lg transition-all flex items-start gap-3">
        <svg class="w-5 h-5 flex-shrink-0 mt-0.5" fill="none" stroke="currentColor" stroke-width="2" viewbox="0 0 24 24" style="color: var(--color-secondary)"><path stroke-linecap="round" stroke-linejoin="round" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" /> <path stroke-linecap="round" stroke-linejoin="round" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z" />
        </svg>
        <div>
         <p class="text-sm font-semibold text-primary">Transparencia</p>
         <p class="text-xs text-gray-600 mt-1">Asegurar trazabilidad y rendici√≥n de cuentas</p>
        </div>
       </div>
      </div>
     </div><!-- Key Indicators -->
     <div class="bg-white p-6 rounded-xl shadow-lg">
      <h3 class="text-lg font-bold text-primary mb-4 flex items-center gap-2">
       <svg class="w-7 h-7" fill="none" stroke="currentColor" stroke-width="2" viewbox="0 0 24 24" style="color: var(--color-medium)"><path stroke-linecap="round" stroke-linejoin="round" d="M16 8v8m-4-5v5m-4-2v2m-2 4h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z" />
       </svg> Indicadores Clave</h3>
      <div class="space-y-4">
       <div class="flex items-center gap-3">
        <div class="w-10 h-10 rounded-full flex items-center justify-center flex-shrink-0" style="background: linear-gradient(135deg, var(--color-secondary), #b8c000)">
         <svg class="w-5 h-5" fill="none" stroke="currentColor" stroke-width="2.5" viewbox="0 0 24 24" style="color: var(--color-primary)"><path stroke-linecap="round" stroke-linejoin="round" d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1" />
         </svg>
        </div>
        <div class="flex-1">
         <p class="font-semibold text-sm text-primary">ROI Real</p>
         <p class="text-xs text-gray-600">Rentabilidad sobre inversi√≥n</p>
        </div>
       </div>
       <div class="flex items-center gap-3">
        <div class="w-10 h-10 rounded-full flex items-center justify-center flex-shrink-0" style="background: linear-gradient(135deg, var(--color-medium), var(--color-primary))">
         <svg class="w-5 h-5" fill="none" stroke="white" stroke-width="2.5" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" />
         </svg>
        </div>
        <div class="flex-1">
         <p class="font-semibold text-sm text-primary">Tiempo de ejecuci√≥n</p>
         <p class="text-xs text-gray-600">Eficiencia del proceso</p>
        </div>
       </div>
       <div class="flex items-center gap-3">
        <div class="w-10 h-10 rounded-full flex items-center justify-center flex-shrink-0" style="background: linear-gradient(135deg, var(--color-secondary), #b8c000)">
         <svg class="w-5 h-5" fill="none" stroke="currentColor" stroke-width="2.5" viewbox="0 0 24 24" style="color: var(--color-primary)"><path stroke-linecap="round" stroke-linejoin="round" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
         </svg>
        </div>
        <div class="flex-1">
         <p class="font-semibold text-sm text-primary">Cumplimiento</p>
         <p class="text-xs text-gray-600">Adherencia a normativa</p>
        </div>
       </div>
      </div>
     </div><!-- Risk Matrix -->
     <div class="bg-white p-6 rounded-xl shadow-lg">
      <h3 class="text-lg font-bold text-primary mb-4 flex items-center gap-2">
       <svg class="w-7 h-7" fill="none" stroke="currentColor" stroke-width="2" viewbox="0 0 24 24" style="color: var(--color-medium)"><path stroke-linecap="round" stroke-linejoin="round" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z" />
       </svg> Matriz Riesgo-Rentabilidad</h3><!-- Risk Matrix Grid -->
      <div class="space-y-2"><!-- Header Labels -->
       <div class="grid grid-cols-4 gap-1 text-xs font-bold text-center mb-2">
        <div class="text-gray-500">
         Riesgo ‚Üí
        </div>
        <div class="text-green-700">
         Bajo
        </div>
        <div class="text-yellow-700">
         Medio
        </div>
        <div class="text-red-700">
         Alto
        </div>
       </div><!-- High Return Row -->
       <div class="grid grid-cols-4 gap-1">
        <div class="flex items-center justify-center text-xs font-bold text-green-700 bg-green-50 rounded p-2">
         Alta<br>
         Rentab.
        </div>
        <div class="aspect-square rounded flex items-center justify-center text-xs font-semibold" style="background: linear-gradient(135deg, #059669 0%, #10b981 100%); color: white;">
         √ìPTIMA
        </div>
        <div class="aspect-square rounded flex items-center justify-center text-xs font-semibold" style="background: linear-gradient(135deg, #10b981 0%, #f59e0b 100%); color: white;">
         BUENA
        </div>
        <div class="aspect-square rounded flex items-center justify-center text-xs font-semibold" style="background: linear-gradient(135deg, #f59e0b 0%, #ef4444 100%); color: white;">
         EVALUAR
        </div>
       </div><!-- Medium Return Row -->
       <div class="grid grid-cols-4 gap-1">
        <div class="flex items-center justify-center text-xs font-bold text-yellow-700 bg-yellow-50 rounded p-2">
         Media<br>
         Rentab.
        </div>
        <div class="aspect-square rounded flex items-center justify-center text-xs font-semibold" style="background: linear-gradient(135deg, #10b981 0%, #f59e0b 100%); color: white;">
         BUENA
        </div>
        <div class="aspect-square rounded flex items-center justify-center text-xs font-semibold" style="background: linear-gradient(135deg, #f59e0b 0%, #ef4444 100%); color: white;">
         MODERADA
        </div>
        <div class="aspect-square rounded flex items-center justify-center text-xs font-semibold" style="background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%); color: white;">
         RIESGOSA
        </div>
       </div><!-- Low Return Row -->
       <div class="grid grid-cols-4 gap-1">
        <div class="flex items-center justify-center text-xs font-bold text-red-700 bg-red-50 rounded p-2">
         Baja<br>
         Rentab.
        </div>
        <div class="aspect-square rounded flex items-center justify-center text-xs font-semibold" style="background: linear-gradient(135deg, #f59e0b 0%, #ef4444 100%); color: white;">
         EVALUAR
        </div>
        <div class="aspect-square rounded flex items-center justify-center text-xs font-semibold" style="background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%); color: white;">
         NO RECOMEND.
        </div>
        <div class="aspect-square rounded flex items-center justify-center text-xs font-semibold" style="background: linear-gradient(135deg, #dc2626 0%, #991b1b 100%); color: white;">
         RECHAZAR
        </div>
       </div>
      </div><!-- Legend -->
      <div class="mt-4 pt-4 border-t border-gray-200">
       <p class="text-xs font-semibold text-gray-700 mb-2">Clasificaci√≥n de Inversiones:</p>
       <div class="grid grid-cols-2 gap-2 text-xs">
        <div class="flex items-center gap-2">
         <div class="w-3 h-3 rounded" style="background: #10b981"></div><span class="text-gray-600">√ìptima/Buena</span>
        </div>
        <div class="flex items-center gap-2">
         <div class="w-3 h-3 rounded" style="background: #f59e0b"></div><span class="text-gray-600">Moderada</span>
        </div>
        <div class="flex items-center gap-2">
         <div class="w-3 h-3 rounded" style="background: #ef4444"></div><span class="text-gray-600">Riesgosa</span>
        </div>
        <div class="flex items-center gap-2">
         <div class="w-3 h-3 rounded" style="background: #991b1b"></div><span class="text-gray-600">No viable</span>
        </div>
       </div>
      </div>
     </div>
    </aside>
   </main><!-- PROCESS FLOW DIAGRAM -->
   <section class="mt-10 bg-white p-4 sm:p-6 md:p-8 rounded-xl shadow-lg">
    <h2 class="text-lg sm:text-xl md:text-2xl font-bold text-primary border-b-2 border-secondary pb-2 mb-6 flex flex-col sm:flex-row items-center gap-2 sm:gap-3 text-center sm:text-left" style="font-family: 'Tw Cen MT', sans-serif;">
     <svg class="w-6 h-6 sm:w-8 sm:h-8" fill="none" stroke="currentColor" stroke-width="2" viewbox="0 0 24 24" style="color: var(--color-secondary)"><path stroke-linecap="round" stroke-linejoin="round" d="M13 10V3L4 14h7v7l9-11h-7z" />
     </svg><strong>DIAGRAMA DE FLUJO DEL PROCEDIMIENTO</strong></h2>
    <div class="grid grid-cols-1 lg:grid-cols-3 gap-8"><!-- Flow Diagram - Left/Center -->
     <div class="lg:col-span-2 relative">
      <div class="relative py-6"><!-- Step 1: Start Circle -->
       <div class="flex flex-col items-center mb-3">
        <div class="w-16 h-16 sm:w-20 sm:h-20 rounded-full bg-secondary flex items-center justify-center shadow-lg">
         <svg class="w-8 h-8 sm:w-10 sm:h-10 text-primary" fill="none" stroke="currentColor" stroke-width="3" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z" /> <path stroke-linecap="round" stroke-linejoin="round" d="M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
         </svg>
        </div>
        <p class="text-xs sm:text-sm font-bold text-primary mt-2">INICIO</p>
        <svg class="w-5 h-6 sm:w-6 sm:h-8 text-medium" fill="currentColor" viewbox="0 0 24 24"><path d="M12 20l-8-8h5V4h6v8h5z" />
        </svg>
       </div><!-- Step 1: IDENTIFICACI√ìN -->
       <div class="flex flex-col items-center mb-3">
        <div class="bg-gradient-to-br from-primary to-medium text-white px-4 py-3 sm:px-8 sm:py-4 rounded-xl shadow-lg w-full max-w-xs sm:w-80 text-center">
         <p class="font-bold text-base sm:text-lg" style="font-family: 'Tw Cen MT', sans-serif;">1. IDENTIFICACI√ìN</p>
         <p class="text-xs sm:text-sm mt-1" style="font-family: 'Tw Cen MT', sans-serif;">Detecci√≥n de necesidades</p>
        </div>
        <svg class="w-5 h-6 sm:w-6 sm:h-8 text-medium" fill="currentColor" viewbox="0 0 24 24"><path d="M12 20l-8-8h5V4h6v8h5z" />
        </svg>
       </div><!-- Step 2: AN√ÅLISIS -->
       <div class="flex flex-col items-center mb-3">
        <div class="bg-gradient-to-br from-medium to-primary text-white px-4 py-3 sm:px-8 sm:py-4 rounded-xl shadow-lg w-full max-w-xs sm:w-80 text-center">
         <p class="font-bold text-base sm:text-lg" style="font-family: 'Tw Cen MT', sans-serif;">2. AN√ÅLISIS Y EVALUACI√ìN</p>
         <p class="text-xs sm:text-sm mt-1" style="font-family: 'Tw Cen MT', sans-serif;">Estudio t√©cnico y financiero</p>
        </div>
        <svg class="w-5 h-6 sm:w-6 sm:h-8 text-medium" fill="currentColor" viewbox="0 0 24 24"><path d="M12 20l-8-8h5V4h6v8h5z" />
        </svg>
       </div><!-- Decision Diamond -->
       <div class="flex flex-col items-center mb-4 sm:mb-6">
        <div class="relative w-32 h-32 sm:w-40 sm:h-40 flex items-center justify-center">
         <div class="absolute transform rotate-45 bg-secondary w-24 h-24 sm:w-32 sm:h-32 shadow-lg"></div>
         <div class="relative z-20 text-center">
          <p class="font-bold text-sm sm:text-base text-primary" style="font-family: 'Tw Cen MT', sans-serif;">¬øViable?</p>
         </div>
        </div>
       </div><!-- Two-path split -->
       <div class="grid grid-cols-1 sm:grid-cols-2 gap-4 sm:gap-8 mb-6 relative"><!-- Left arrow from diamond (hidden on mobile) -->
        <div class="hidden sm:block absolute top-0 left-1/4 transform -translate-x-1/2" style="width: 2px; height: 40px; background: #ef4444;"></div>
        <div class="hidden sm:block absolute top-10 left-1/4 transform -translate-x-1/2">
         <svg class="w-6 h-8 text-red-600" fill="currentColor" viewbox="0 0 24 24"><path d="M12 20l-8-8h5V4h6v8h5z" />
         </svg>
        </div><!-- Right arrow from diamond (hidden on mobile) -->
        <div class="hidden sm:block absolute top-0 right-1/4 transform translate-x-1/2" style="width: 2px; height: 40px; background: #10b981;"></div>
        <div class="hidden sm:block absolute top-10 right-1/4 transform translate-x-1/2">
         <svg class="w-6 h-8 text-green-600" fill="currentColor" viewbox="0 0 24 24"><path d="M12 20l-8-8h5V4h6v8h5z" />
         </svg>
        </div><!-- NO Path (Left) -->
        <div class="flex flex-col items-center pt-4 sm:pt-16">
         <div class="bg-red-600 text-white px-4 py-2 rounded-lg font-bold text-xs sm:text-sm mb-3 sm:mb-4 shadow-lg flex items-center gap-2"><span style="color: white;">‚ùå</span> <span>NO VIABLE</span>
         </div><!-- Rejection Box -->
         <div class="bg-gradient-to-br from-red-600 to-red-800 text-white px-4 py-3 sm:px-6 sm:py-4 rounded-xl shadow-lg w-full max-w-xs sm:w-72 text-center border-2 sm:border-4 border-red-700">
          <svg class="w-10 h-10 sm:w-12 sm:h-12 mx-auto mb-2" fill="none" stroke="currentColor" stroke-width="2.5" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" />
          </svg>
          <p class="font-bold text-sm sm:text-base" style="font-family: 'Tw Cen MT', sans-serif;">RECHAZAR PROPUESTA</p>
          <p class="text-xs mt-2" style="font-family: 'Tw Cen MT', sans-serif;">No cumple con criterios de viabilidad</p>
         </div>
         <svg class="w-5 h-6 sm:w-6 sm:h-8 text-red-600 my-2" fill="currentColor" viewbox="0 0 24 24"><path d="M12 20l-8-8h5V4h6v8h5z" />
         </svg><!-- Alternatives Box -->
         <div class="bg-gradient-to-br from-orange-500 to-orange-600 text-white px-4 py-3 sm:px-6 sm:py-4 rounded-xl shadow-lg w-full max-w-xs sm:w-72 text-center border-2 border-orange-700">
          <svg class="w-8 h-8 sm:w-10 sm:h-10 mx-auto mb-2" fill="none" stroke="currentColor" stroke-width="2" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15" />
          </svg>
          <p class="font-bold text-xs sm:text-sm" style="font-family: 'Tw Cen MT', sans-serif;">BUSCAR ALTERNATIVAS</p>
          <p class="text-xs mt-1" style="font-family: 'Tw Cen MT', sans-serif;">Reevaluar nuevas opciones de inversi√≥n</p>
         </div><!-- Curved arrow back to start -->
         <svg class="mt-3 sm:mt-4 hidden sm:block" width="120" height="80" viewbox="0 0 120 80" fill="none"><path d="M60 0 Q20 40, 20 80" stroke="#f97316" stroke-width="3" stroke-dasharray="6,6" fill="none" /> <path d="M15 70 L20 80 L25 70" fill="#f97316" />
         </svg>
         <p class="text-xs text-orange-600 font-semibold mt-2 hidden sm:block">Volver al inicio</p>
        </div><!-- YES Path (Right) -->
        <div class="flex flex-col items-center pt-4 sm:pt-16">
         <div class="bg-green-600 text-white px-4 py-2 rounded-lg font-bold text-xs sm:text-sm mb-3 sm:mb-4 shadow-lg flex items-center gap-2"><span style="color: white;">‚úÖ</span> <span>VIABLE</span>
         </div><!-- Step 3: APROBACI√ìN -->
         <div class="bg-gradient-to-br from-primary to-medium text-white px-4 py-3 sm:px-8 sm:py-4 rounded-xl shadow-lg w-full max-w-xs sm:w-72 text-center mb-2 sm:mb-3">
          <p class="font-bold text-sm sm:text-base" style="font-family: 'Tw Cen MT', sans-serif;">3. APROBACI√ìN</p>
          <p class="text-xs mt-1" style="font-family: 'Tw Cen MT', sans-serif;">Decisi√≥n y presupuesto</p>
         </div>
         <svg class="w-5 h-6 sm:w-6 sm:h-8 text-medium mb-2 sm:mb-3" fill="currentColor" viewbox="0 0 24 24"><path d="M12 20l-8-8h5V4h6v8h5z" />
         </svg><!-- Step 4: EJECUCI√ìN -->
         <div class="bg-gradient-to-br from-medium to-primary text-white px-4 py-3 sm:px-8 sm:py-4 rounded-xl shadow-lg w-full max-w-xs sm:w-72 text-center mb-2 sm:mb-3">
          <p class="font-bold text-sm sm:text-base" style="font-family: 'Tw Cen MT', sans-serif;">4. EJECUCI√ìN</p>
          <p class="text-xs mt-1" style="font-family: 'Tw Cen MT', sans-serif;">Formalizaci√≥n y desembolso</p>
         </div>
         <svg class="w-5 h-6 sm:w-6 sm:h-8 text-medium mb-2 sm:mb-3" fill="currentColor" viewbox="0 0 24 24"><path d="M12 20l-8-8h5V4h6v8h5z" />
         </svg><!-- Step 5: SEGUIMIENTO -->
         <div class="bg-gradient-to-br from-primary to-medium text-white px-4 py-3 sm:px-8 sm:py-4 rounded-xl shadow-lg w-full max-w-xs sm:w-72 text-center mb-2 sm:mb-3">
          <p class="font-bold text-sm sm:text-base" style="font-family: 'Tw Cen MT', sans-serif;">5. SEGUIMIENTO</p>
          <p class="text-xs mt-1" style="font-family: 'Tw Cen MT', sans-serif;">Monitoreo continuo</p>
         </div>
         <svg class="w-5 h-6 sm:w-6 sm:h-8 text-medium mb-2 sm:mb-3" fill="currentColor" viewbox="0 0 24 24"><path d="M12 20l-8-8h5V4h6v8h5z" />
         </svg><!-- Step 6: CIERRE -->
         <div class="bg-gradient-to-br from-medium to-primary text-white px-4 py-3 sm:px-8 sm:py-4 rounded-xl shadow-lg w-full max-w-xs sm:w-72 text-center mb-2 sm:mb-3">
          <p class="font-bold text-sm sm:text-base" style="font-family: 'Tw Cen MT', sans-serif;">6. CIERRE Y EVALUACI√ìN</p>
          <p class="text-xs mt-1" style="font-family: 'Tw Cen MT', sans-serif;">Liquidaci√≥n y an√°lisis final</p>
         </div>
         <svg class="w-5 h-6 sm:w-6 sm:h-8 text-medium mb-2 sm:mb-3" fill="currentColor" viewbox="0 0 24 24"><path d="M12 20l-8-8h5V4h6v8h5z" />
         </svg><!-- End Circle -->
         <div class="w-16 h-16 sm:w-20 sm:h-20 rounded-full bg-secondary flex items-center justify-center shadow-lg mt-2">
          <svg class="w-8 h-8 sm:w-10 sm:h-10 text-primary" fill="none" stroke="currentColor" stroke-width="3" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M5 13l4 4L19 7" />
          </svg>
         </div>
         <p class="text-xs sm:text-sm font-bold text-primary mt-2">FIN</p>
        </div>
       </div>
      </div><!-- Flow Legend -->
      <div class="mt-8 pt-6 border-t border-gray-200">
       <div class="flex flex-wrap justify-center gap-6 text-sm" style="font-family: 'Tw Cen MT', sans-serif;">
        <div class="flex items-center gap-2">
         <div class="w-12 h-8 bg-gradient-to-br from-primary to-medium rounded"></div><span class="text-gray-700">Proceso</span>
        </div>
        <div class="flex items-center gap-2">
         <div class="w-8 h-8 bg-secondary transform rotate-45"></div><span class="text-gray-700 ml-2">Decisi√≥n</span>
        </div>
        <div class="flex items-center gap-2">
         <svg class="w-6 h-6 text-medium" fill="currentColor" viewbox="0 0 24 24"><path d="M12 4l-8 8h5v8h6v-8h5z" />
         </svg><span class="text-gray-700">Flujo</span>
        </div>
        <div class="flex items-center gap-2">
         <div class="w-8 h-8 rounded-full bg-secondary"></div><span class="text-gray-700">Fin</span>
        </div>
       </div>
      </div>
     </div><!-- SWOT Matrix - Right -->
     <div class="lg:col-span-1">
      <h3 class="text-xl font-bold text-primary mb-4 flex items-center gap-2" style="font-family: 'Tw Cen MT', sans-serif;">
       <svg class="w-7 h-7" fill="none" stroke="currentColor" stroke-width="2" viewbox="0 0 24 24" style="color: var(--color-secondary)"><path stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-3 7h3m-3 4h3m-6-4h.01M9 16h.01" />
       </svg><strong>MATRIZ DOFA</strong></h3>
      <div class="grid grid-cols-2 gap-2"><!-- Fortalezas (Strengths) -->
       <div class="bg-gradient-to-br from-primary to-medium p-4 rounded-lg shadow-md">
        <h4 class="font-bold text-white text-sm mb-3 flex items-center gap-2">
         <svg class="w-5 h-5" fill="none" stroke="currentColor" stroke-width="2.5" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
         </svg> FORTALEZAS</h4>
        <ul class="space-y-2 text-xs text-white">
         <li class="flex items-start gap-1"><span style="color: var(--color-secondary)">  </span> <span>Normativa clara y definida</span></li>
         <li class="flex items-start gap-1"><span style="color: var(--color-secondary)">‚Ä¢</span> <span>Personal especializado</span></li>
         <li class="flex items-start gap-1"><span style="color: var(--color-secondary)">‚Ä¢</span> <span>Sistemas de control interno</span></li>
         <li class="flex items-start gap-1"><span style="color: var(--color-secondary)">‚Ä¢</span> <span>Trazabilidad completa</span></li>
        </ul>
       </div><!-- Oportunidades (Opportunities) -->
       <div class="bg-gradient-to-br from-secondary p-4 rounded-lg shadow-md" style="background: linear-gradient(to bottom right, var(--color-secondary), #b8c000);">
        <h4 class="font-bold text-sm mb-3 flex items-center gap-2" style="color: var(--color-primary)">
         <svg class="w-5 h-5" fill="none" stroke="currentColor" stroke-width="2.5" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M13 7h8m0 0v8m0-8l-8 8-4-4-6 6" />
         </svg> OPORTUNIDADES</h4>
        <ul class="space-y-2 text-xs" style="color: #000000">
         <li class="flex items-start gap-1"><span style="color: #000000">‚Ä¢</span> <span>Mercado financiero diversificado</span></li>
         <li class="flex items-start gap-1"><span style="color: #000000">‚Ä¢</span> <span>Nuevas alternativas de inversi√≥n</span></li>
         <li class="flex items-start gap-1"><span style="color: #000000">‚Ä¢</span> <span>Tecnolog√≠as de an√°lisis</span></li>
         <li class="flex items-start gap-1"><span style="color: #000000">‚Ä¢</span> <span>Alianzas estrat√©gicas</span></li>
        </ul>
       </div><!-- Debilidades (Weaknesses) -->
       <div class="bg-gradient-to-br p-4 rounded-lg shadow-md" style="background: linear-gradient(to bottom right, #b8c000, #a0a800);">
        <h4 class="font-bold text-sm mb-3 flex items-center gap-2" style="color: #000000">
         <svg class="w-5 h-5" fill="none" stroke="currentColor" stroke-width="2.5" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z" />
         </svg> DEBILIDADES</h4>
        <ul class="space-y-2 text-xs" style="color: #000000">
         <li class="flex items-start gap-1"><span style="color: #000000">‚Ä¢</span> <span>Procesos manuales en an√°lisis de datos</span></li>
         <li class="flex items-start gap-1"><span style="color: #000000">‚Ä¢</span> <span>Centralizaci√≥n en la toma de decisiones</span></li>
         <li class="flex items-start gap-1"><span style="color: #000000">‚Ä¢</span> <span>Capacidad tecnol√≥gica limitada</span></li>
         <li class="flex items-start gap-1"><span style="color: #000000">‚Ä¢</span> <span>Tiempos de respuesta ante volatilidad</span></li>
        </ul>
       </div><!-- Amenazas (Threats) -->
       <div class="bg-gradient-to-br from-medium to-primary p-4 rounded-lg shadow-md">
        <h4 class="font-bold text-white text-sm mb-3 flex items-center gap-2">
         <svg class="w-5 h-5" fill="none" stroke="currentColor" stroke-width="2.5" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M20.618 5.984A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z" />
         </svg> AMENAZAS</h4>
        <ul class="space-y-2 text-xs text-white">
         <li class="flex items-start gap-1"><span style="color: var(--color-secondary)">‚Ä¢</span> <span>Volatilidad del mercado</span></li>
         <li class="flex items-start gap-1"><span style="color: var(--color-secondary)">‚Ä¢</span> <span>Cambios regulatorios</span></li>
         <li class="flex items-start gap-1"><span style="color: var(--color-secondary)">‚Ä¢</span> <span>Crisis econ√≥micas</span></li>
         <li class="flex items-start gap-1"><span style="color: var(--color-secondary)">‚Ä¢</span> <span>Riesgos de liquidez</span></li>
        </ul>
       </div>
      </div><!-- SWOT Analysis Summary -->
      <div class="mt-4 bg-gradient-to-r from-primary to-medium p-4 rounded-lg shadow-md">
       <p class="text-xs text-white font-semibold mb-2">üí° Estrategia Recomendada:</p>
       <p class="text-xs text-white">Aprovechar las fortalezas institucionales y oportunidades del mercado para mitigar debilidades y amenazas mediante diversificaci√≥n y seguimiento continuo.</p>
      </div><!-- ROLES DIAGRAM - Below SWOT -->
      <div class="mt-6 bg-white p-4 sm:p-6 rounded-xl shadow-lg border-2 border-primary">
       <h3 class="text-lg sm:text-xl font-bold text-primary mb-4 flex items-center gap-2" style="font-family: 'Tw Cen MT', sans-serif;">
        <svg class="w-6 h-6 sm:w-7 sm:h-7" fill="none" stroke="currentColor" stroke-width="2" viewbox="0 0 24 24" style="color: var(--color-secondary)"><path stroke-linecap="round" stroke-linejoin="round" d="M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z" />
        </svg><strong>COMIT√â DE INVERSIONES</strong></h3>
       <p class="text-xs text-gray-600 mb-4 sm:mb-6 italic">Haz clic en cada rol para ver sus responsabilidades</p><!-- Circular Diagram -->
       <div class="relative" style="height: 380px;"><!-- Center Circle - Committee -->
        <div class="absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 z-10">
         <div class="w-32 h-32 rounded-full flex items-center justify-center shadow-2xl border-4 border-white" style="background: linear-gradient(135deg, var(--color-primary), var(--color-medium))">
          <div class="text-center">
           <svg class="w-12 h-12 text-white mx-auto mb-1" fill="none" stroke="currentColor" stroke-width="2" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z" />
           </svg>
           <p class="text-xs font-bold text-white leading-tight">COMIT√â<br>
            INVERSIONES</p>
          </div>
         </div>
        </div><!-- Connecting Lines (SVG) -->
        <svg class="absolute inset-0 w-full h-full pointer-events-none" style="z-index: 1;"><!-- Line to Gerente (Top) --> <line x1="50%" y1="50%" x2="50%" y2="15%" stroke="var(--color-medium)" stroke-width="2" stroke-dasharray="4,4" opacity="0.5" /> <!-- Line to Jefatura Financiera (Top Right) --> <line x1="50%" y1="50%" x2="85%" y2="25%" stroke="var(--color-medium)" stroke-width="2" stroke-dasharray="4,4" opacity="0.5" /> <!-- Line to Jefe Comercial (Bottom Right) --> <line x1="50%" y1="50%" x2="85%" y2="75%" stroke="var(--color-medium)" stroke-width="2" stroke-dasharray="4,4" opacity="0.5" /> <!-- Line to Oficina de Riesgos (Bottom Left) --> <line x1="50%" y1="50%" x2="15%" y2="75%" stroke="var(--color-secondary)" stroke-width="2" stroke-dasharray="4,4" opacity="0.5" /> <!-- Line to Asesor Jur√≠dico (Top Left) --> <line x1="50%" y1="50%" x2="15%" y2="25%" stroke="var(--color-secondary)" stroke-width="2" stroke-dasharray="4,4" opacity="0.5" />
        </svg><!-- Role 1: Gerente (Top - 12 o'clock) -->
        <div class="absolute top-0 left-1/2 transform -translate-x-1/2" style="z-index: 5;">
         <div class="role-card bg-white p-2 rounded-lg shadow-lg cursor-pointer transition-all hover:shadow-2xl hover:scale-110 border-2 border-transparent hover:border-primary" data-role="gerente" style="width: 90px;">
          <div class="flex flex-col items-center">
           <div class="w-10 h-10 rounded-full flex items-center justify-center mb-1 shadow-md" style="background: linear-gradient(135deg, var(--color-secondary), #b8c000)">
            <svg class="w-5 h-5" fill="none" stroke="currentColor" stroke-width="2" viewbox="0 0 24 24" style="color: var(--color-primary)"><path stroke-linecap="round" stroke-linejoin="round" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" />
            </svg>
           </div>
           <p class="text-xs font-bold text-primary text-center leading-tight">Gerente</p>
          </div>
         </div>
        </div><!-- Role 2: Jefatura Financiera (Top Right - 2 o'clock) -->
        <div class="absolute top-12 right-0 transform translate-x-0" style="z-index: 5;">
         <div class="role-card bg-white p-2 rounded-lg shadow-lg cursor-pointer transition-all hover:shadow-2xl hover:scale-110 border-2 border-transparent hover:border-primary" data-role="jefatura_financiera" style="width: 90px;">
          <div class="flex flex-col items-center">
           <div class="w-10 h-10 rounded-full flex items-center justify-center mb-1 shadow-md" style="background: linear-gradient(135deg, var(--color-secondary), #b8c000)">
            <svg class="w-5 h-5" fill="none" stroke="currentColor" stroke-width="2" viewbox="0 0 24 24" style="color: var(--color-primary)"><path stroke-linecap="round" stroke-linejoin="round" d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
            </svg>
           </div>
           <p class="text-xs font-bold text-primary text-center leading-tight">Jefatura<br>
            Financiera</p>
          </div>
         </div>
        </div><!-- Role 3: Jefe Comercial (Bottom Right - 4 o'clock) -->
        <div class="absolute bottom-12 right-0 transform translate-x-0" style="z-index: 5;">
         <div class="role-card bg-white p-2 rounded-lg shadow-lg cursor-pointer transition-all hover:shadow-2xl hover:scale-110 border-2 border-transparent hover:border-medium" data-role="jefe_comercial" style="width: 90px;">
          <div class="flex flex-col items-center">
           <div class="w-10 h-10 rounded-full flex items-center justify-center mb-1 shadow-md" style="background: linear-gradient(135deg, var(--color-secondary), #b8c000)">
            <svg class="w-5 h-5" fill="none" stroke="currentColor" stroke-width="2" viewbox="0 0 24 24" style="color: var(--color-primary)"><path stroke-linecap="round" stroke-linejoin="round" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z" />
            </svg>
           </div>
           <p class="text-xs font-bold text-primary text-center leading-tight">Jefe<br>
            Comercial</p>
          </div>
         </div>
        </div><!-- Role 4: Oficina de Riesgos (Bottom Left - 8 o'clock) -->
        <div class="absolute bottom-12 left-0 transform -translate-x-0" style="z-index: 5;">
         <div class="role-card bg-white p-2 rounded-lg shadow-lg cursor-pointer transition-all hover:shadow-2xl hover:scale-110 border-2 border-transparent hover:border-secondary" data-role="oficina_riesgos" style="width: 90px;">
          <div class="flex flex-col items-center">
           <div class="w-10 h-10 rounded-full flex items-center justify-center mb-1 shadow-md" style="background: linear-gradient(135deg, var(--color-secondary), #b8c000)">
            <svg class="w-5 h-5" fill="none" stroke="currentColor" stroke-width="2" viewbox="0 0 24 24" style="color: var(--color-primary)"><path stroke-linecap="round" stroke-linejoin="round" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z" />
            </svg>
           </div>
           <p class="text-xs font-bold text-primary text-center leading-tight">Oficina de<br>
            Riesgos</p>
          </div>
         </div>
        </div><!-- Role 5: Asesor Jur√≠dico (Top Left - 10 o'clock) -->
        <div class="absolute top-12 left-0 transform -translate-x-0" style="z-index: 5;">
         <div class="role-card bg-white p-2 rounded-lg shadow-lg cursor-pointer transition-all hover:shadow-2xl hover:scale-110 border-2 border-transparent hover:border-secondary" data-role="asesor_juridico" style="width: 90px;">
          <div class="flex flex-col items-center">
           <div class="w-10 h-10 rounded-full flex items-center justify-center mb-1 shadow-md" style="background: linear-gradient(135deg, var(--color-secondary), #b8c000)">
            <svg class="w-5 h-5" fill="none" stroke="currentColor" stroke-width="2" viewbox="0 0 24 24" style="color: var(--color-primary)"><path stroke-linecap="round" stroke-linejoin="round" d="M3 6l3 1m0 0l-3 9a5.002 5.002 0 006.001 0M6 7l3 9M6 7l6-2m6 2l3-1m-3 1l-3 9a5.002 5.002 0 006.001 0M18 7l3 9m-3-9l-6-2m0-2v2m0 16V5m0 16H9m3 0h3" />
            </svg>
           </div>
           <p class="text-xs font-bold text-primary text-center leading-tight">Asesor<br>
            Jur√≠dico</p>
          </div>
         </div>
        </div>
       </div><!-- Role Details Panel -->
       <div id="role-details" class="mt-6 hidden">
        <div class="bg-gradient-to-br from-gray-50 to-gray-100 p-5 rounded-xl border-2" id="role-details-content"><!-- Content will be dynamically inserted here -->
        </div>
       </div>
      </div>
     </div>
    </div>
   </section><!-- INVESTMENT SIMULATOR -->
   <section class="mt-10 bg-white p-4 sm:p-6 md:p-8 rounded-xl shadow-2xl border-t-8 border-primary">
    <div class="flex flex-col sm:flex-row items-center sm:items-start gap-3 sm:gap-4 mb-6">
     <div class="w-12 h-12 sm:w-16 sm:h-16 rounded-full flex items-center justify-center shadow-lg flex-shrink-0" style="background: linear-gradient(135deg, var(--color-primary), var(--color-medium))">
      <svg class="w-6 h-6 sm:w-8 sm:h-8 text-white" fill="none" stroke="currentColor" stroke-width="2.5" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M9 7h6m0 10v-3m-3 3h.01M9 17h.01M9 14h.01M12 14h.01M15 11h.01M12 11h.01M9 11h.01M7 21h10a2 2 0 002-2V5a2 2 0 00-2-2H7a2 2 0 00-2 2v14a2 2 0 002 2z" />
      </svg>
     </div>
     <div class="text-center sm:text-left">
      <h2 class="text-xl sm:text-2xl md:text-3xl font-bold text-primary" style="font-family: 'Tw Cen MT', sans-serif;">SIMULADOR DE VIABILIDAD DE INVERSI√ìN</h2>
      <p class="text-sm sm:text-base text-gray-600 mt-1">Eval√∫a la viabilidad de tu inversi√≥n seg√∫n la matriz riesgo-rentabilidad</p>
     </div>
    </div>
    <div class="grid grid-cols-1 lg:grid-cols-2 gap-8"><!-- Input Section -->
     <div class="space-y-6">
      <div class="bg-gradient-to-br from-gray-50 to-gray-100 p-6 rounded-xl">
       <h3 class="text-xl font-bold text-primary mb-4 flex items-center gap-2">
        <svg class="w-6 h-6" fill="none" stroke="currentColor" stroke-width="2" viewbox="0 0 24 24" style="color: var(--color-secondary)"><path stroke-linecap="round" stroke-linejoin="round" d="M12 6v6m0 0v6m0-6h6m-6 0H6" />
        </svg> Par√°metros de Inversi√≥n</h3><!-- Investment Value -->
       <div class="mb-6"><label for="investment-value" class="block text-sm font-bold text-gray-700 mb-2"> Valor de la Inversi√≥n (COP) </label>
        <div class="relative"><span class="absolute left-4 top-1/2 transform -translate-y-1/2 text-gray-500 font-bold">$</span> <input type="number" id="investment-value" min="1000000" step="1000000" value="100000000" class="w-full pl-10 pr-4 py-3 border-2 border-gray-300 rounded-lg focus:border-primary focus:outline-none text-lg font-semibold">
        </div>
        <p class="text-xs text-gray-500 mt-1">M√≠nimo: $1,000,000 COP</p>
       </div><!-- Time Period -->
       <div class="mb-6"><label for="time-period" class="block text-sm font-bold text-gray-700 mb-2"> Tiempo de Inversi√≥n (meses) </label> <input type="number" id="time-period" min="1" max="360" value="12" class="w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:border-primary focus:outline-none text-lg font-semibold">
        <div class="flex justify-between mt-2"><span class="text-xs text-gray-500">M√≠nimo: 1 mes</span> <span class="text-xs text-gray-500">M√°ximo: 360 meses</span>
        </div>
       </div><!-- Return Rate -->
       <div class="mb-6"><label for="return-rate" class="block text-sm font-bold text-gray-700 mb-2"> Tasa E.A. (Efectivo Anual) % </label> <input type="number" id="return-rate" min="0" max="100" step="0.1" value="8.5" class="w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:border-primary focus:outline-none text-lg font-semibold">
        <div class="flex justify-between mt-2"><span class="text-xs text-gray-500">0% - 100%</span>
        </div>
        <p class="text-xs text-gray-600 mt-2 italic">Tasa Efectiva Anual - La tasa real que genera el capital en un a√±o</p>
       </div><!-- Risk Level -->
       <div class="mb-6"><label for="risk-level" class="block text-sm font-bold text-gray-700 mb-2"> Nivel de Riesgo </label> <select id="risk-level" class="w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:border-primary focus:outline-none text-lg font-semibold"> <option value="bajo">Bajo - Inversiones seguras (bonos, CDT)</option> <option value="medio">Medio - Inversiones balanceadas (fondos mixtos)</option> <option value="alto">Alto - Inversiones de crecimiento (acciones, renta variable)</option> </select>
       </div><!-- Calculate Button --> <button id="calculate-btn" class="w-full py-4 rounded-xl font-bold text-white text-lg shadow-lg transition-all hover:shadow-xl hover:scale-105" style="background: linear-gradient(135deg, var(--color-primary), var(--color-medium))"> <span class="flex items-center justify-center gap-2">
         <svg class="w-6 h-6" fill="none" stroke="currentColor" stroke-width="2.5" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M9 7h6m0 10v-3m-3 3h.01M9 17h.01M9 14h.01M12 14h.01M15 11h.01M12 11h.01M9 11h.01M7 21h10a2 2 0 002-2V5a2 2 0 00-2-2H7a2 2 0 00-2 2v14a2 2 0 002 2z" />
         </svg> CALCULAR VIABILIDAD </span> </button>
      </div>
     </div><!-- Results Section -->
     <div id="results-section" class="space-y-6 hidden"><!-- Viability Card -->
      <div id="viability-card" class="p-6 rounded-xl shadow-lg border-4">
       <div class="flex items-center gap-4 mb-4">
        <div id="viability-icon" class="w-16 h-16 rounded-full flex items-center justify-center"><!-- Icon will be inserted here -->
        </div>
        <div>
         <h3 class="text-2xl font-bold" id="viability-title">INVERSI√ìN VIABLE</h3>
         <p class="text-sm" id="viability-category">Categor√≠a: √ìptima</p>
        </div>
       </div>
       <p id="viability-description" class="text-sm leading-relaxed"></p>
      </div><!-- Financial Metrics -->
      <div class="bg-white p-6 rounded-xl shadow-lg border-2 border-gray-200">
       <h3 class="text-xl font-bold text-primary mb-4 flex items-center gap-2">
        <svg class="w-6 h-6" fill="none" stroke="currentColor" stroke-width="2" viewbox="0 0 24 24" style="color: var(--color-secondary)"><path stroke-linecap="round" stroke-linejoin="round" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z" />
        </svg> Proyecci√≥n Financiera</h3>
       <div class="space-y-4"><!-- Initial Investment -->
        <div class="flex justify-between items-center p-3 bg-gray-50 rounded-lg"><span class="font-semibold text-gray-700">Inversi√≥n Inicial:</span> <span id="result-initial" class="font-bold text-lg text-primary">$0</span>
        </div><!-- Expected Return -->
        <div class="flex justify-between items-center p-3 bg-gray-50 rounded-lg"><span class="font-semibold text-gray-700">Rendimiento Esperado:</span> <span id="result-return" class="font-bold text-lg text-green-600">$0</span>
        </div><!-- Final Value -->
        <div class="flex justify-between items-center p-4 rounded-lg" style="background: linear-gradient(135deg, var(--color-secondary), #b8c000)"><span class="font-bold" style="color: var(--color-primary)">Valor Final Proyectado:</span> <span id="result-final" class="font-bold text-2xl" style="color: var(--color-primary)">$0</span>
        </div><!-- ROI Percentage -->
        <div class="flex justify-between items-center p-3 bg-gray-50 rounded-lg"><span class="font-semibold text-gray-700">ROI (%):</span> <span id="result-roi" class="font-bold text-lg text-primary">0%</span>
        </div><!-- Investment Period -->
        <div class="flex justify-between items-center p-3 bg-gray-50 rounded-lg"><span class="font-semibold text-gray-700">Plazo:</span> <span id="result-time" class="font-bold text-lg text-primary">0 meses</span>
        </div>
       </div>
      </div><!-- Risk Matrix Position -->
      <div class="bg-white p-6 rounded-xl shadow-lg border-2 border-gray-200">
       <h3 class="text-xl font-bold text-primary mb-4 flex items-center gap-2">
        <svg class="w-6 h-6" fill="none" stroke="currentColor" stroke-width="2" viewbox="0 0 24 24" style="color: var(--color-secondary)"><path stroke-linecap="round" stroke-linejoin="round" d="M9 20l-5.447-2.724A1 1 0 013 16.382V5.618a1 1 0 011.447-.894L9 7m0 13l6-3m-6 3V7m6 10l4.553 2.276A1 1 0 0021 18.382V7.618a1 1 0 00-.553-.894L15 4m0 13V4m0 0L9 7" />
        </svg> Posici√≥n en Matriz de Riesgo</h3>
       <div id="matrix-position" class="p-4 rounded-lg text-center">
        <p class="font-bold text-lg mb-2" id="matrix-text">Calculando posici√≥n...</p>
        <p class="text-sm" id="matrix-recommendation"></p>
       </div>
      </div>
     </div>
    </div><!-- Charts Section - Two Columns Below -->
    <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 mt-8"><!-- Interactive Pie Chart - Left -->
     <div class="bg-white p-6 rounded-xl shadow-lg border-2 border-gray-200">
      <h3 class="text-xl font-bold text-primary mb-4 flex items-center gap-2">
       <svg class="w-6 h-6" fill="none" stroke="currentColor" stroke-width="2" viewbox="0 0 24 24" style="color: var(--color-secondary)"><path stroke-linecap="round" stroke-linejoin="round" d="M11 3.055A9.001 9.001 0 1020.945 13H11V3.055z" /> <path stroke-linecap="round" stroke-linejoin="round" d="M20.488 9H15V3.512A9.025 9.025 0 0120.488 9z" />
       </svg> Composici√≥n de la Inversi√≥n</h3>
      <div class="flex flex-col items-center">
       <svg id="pie-chart" width="280" height="280" viewbox="0 0 280 280" class="mb-4"><!-- Pie chart will be drawn here -->
       </svg>
       <div id="pie-legend" class="w-full space-y-2"><!-- Legend items will be added here -->
       </div>
      </div>
     </div><!-- Interactive Bar Chart - Right -->
     <div class="bg-white p-6 rounded-xl shadow-lg border-2 border-gray-200">
      <h3 class="text-xl font-bold text-primary mb-4 flex items-center gap-2">
       <svg class="w-6 h-6" fill="none" stroke="currentColor" stroke-width="2" viewbox="0 0 24 24" style="color: var(--color-secondary)"><path stroke-linecap="round" stroke-linejoin="round" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z" />
       </svg> Proyecci√≥n de Rendimientos Anuales</h3><!-- Year Selector -->
      <div class="mb-4"><label for="years-selector" class="block text-sm font-bold text-gray-700 mb-2"> A√±os de proyecci√≥n </label> <input type="range" id="years-selector" min="1" max="10" value="5" class="w-full" style="accent-color: var(--color-primary);">
       <div class="flex justify-between text-xs text-gray-500 mt-1"><span>1 a√±o</span> <span id="years-display" class="font-bold text-primary">5 a√±os</span> <span>10 a√±os</span>
       </div>
      </div>
      <div class="flex flex-col items-center">
       <div class="w-full overflow-x-auto">
        <svg id="bar-chart" width="100%" height="350" class="mb-4" style="min-width: 400px;"><!-- Bar chart will be drawn here -->
        </svg>
       </div><!-- Summary Info Panel -->
       <div class="w-full mt-4 p-4 rounded-lg" style="background: linear-gradient(135deg, var(--color-primary), var(--color-medium));">
        <h4 class="text-center text-white font-bold text-sm mb-3">üìä Resumen de Proyecci√≥n</h4>
        <div class="grid grid-cols-3 gap-3">
         <div class="bg-white bg-opacity-20 backdrop-blur-sm rounded-lg p-3 text-center">
          <p class="text-xs text-white font-semibold mb-1">Capital Inicial</p>
          <p id="summary-capital" class="text-base font-bold text-white">$0</p>
         </div>
         <div class="bg-white bg-opacity-20 backdrop-blur-sm rounded-lg p-3 text-center">
          <p class="text-xs text-white font-semibold mb-1">Rendimientos</p>
          <p id="summary-returns" class="text-base font-bold text-white">$0</p>
         </div>
         <div class="bg-white bg-opacity-20 backdrop-blur-sm rounded-lg p-3 text-center">
          <p class="text-xs text-white font-semibold mb-1">Valor Total</p>
          <p id="summary-total" class="text-base font-bold text-white">$0</p>
         </div>
        </div>
       </div>
      </div>
     </div>
    </div>
   </section><!-- FOOTER -->
   <footer class="mt-10 bg-white p-4 rounded-xl shadow-lg text-center text-sm text-gray-600">
    <p style="font-family: 'Tw Cen MT', sans-serif;">¬© 2025 INFIHUILA - Instituto de Financiamiento, Promoci√≥n y Desarrollo del Huila</p>
    <p class="mt-1 text-xs" style="font-family: 'Tw Cen MT', sans-serif;">Documento controlado. Cualquier impresi√≥n es copia no controlada.</p>
   </footer>
  </div><!-- SUGGESTIONS BUTTON --> <button id="suggestions-btn" class="fixed bottom-6 right-6 w-16 h-16 rounded-full shadow-2xl flex items-center justify-center transition-all hover:scale-110 z-50" style="background: linear-gradient(135deg, var(--color-secondary), #b8c000);">
   <svg class="w-8 h-8" fill="none" stroke="currentColor" stroke-width="2.5" viewbox="0 0 24 24" style="color: var(--color-primary)"><path stroke-linecap="round" stroke-linejoin="round" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z" />
   </svg></button> <!-- SUGGESTIONS MODAL -->
  <div id="suggestions-modal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden" style="backdrop-filter: blur(4px);">
   <div class="bg-white rounded-2xl shadow-2xl max-w-2xl w-full mx-4 max-h-[90vh] overflow-y-auto"><!-- Modal Header -->
    <div class="p-6 border-b border-gray-200" style="background: linear-gradient(135deg, var(--color-primary), var(--color-medium));">
     <div class="flex items-center justify-between">
      <div class="flex items-center gap-3">
       <div class="w-12 h-12 rounded-full flex items-center justify-center" style="background: var(--color-secondary);">
        <svg class="w-6 h-6" fill="none" stroke="currentColor" stroke-width="2.5" viewbox="0 0 24 24" style="color: var(--color-primary)"><path stroke-linecap="round" stroke-linejoin="round" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z" />
        </svg>
       </div>
       <div>
        <h3 class="text-2xl font-bold text-white">Buz√≥n de Sugerencias</h3>
        <p class="text-sm text-gray-100 mt-1">Comparte tus ideas para mejorar el procedimiento</p>
       </div>
      </div><button id="close-modal" class="text-white hover:text-gray-200 transition-colors">
       <svg class="w-8 h-8" fill="none" stroke="currentColor" stroke-width="2" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" />
       </svg></button>
     </div>
    </div><!-- Modal Body -->
    <div class="p-6"><!-- Suggestion Form -->
     <form id="suggestion-form" class="space-y-4">
      <div><label for="user-name" class="block text-sm font-semibold text-gray-700 mb-2"> Nombre (opcional) </label> <input type="text" id="user-name" placeholder="Tu nombre" class="w-full px-4 py-3 border-2 border-gray-200 rounded-lg focus:border-primary focus:outline-none transition-colors">
      </div>
      <div><label for="suggestion-category" class="block text-sm font-semibold text-gray-700 mb-2"> Categor√≠a </label> <select id="suggestion-category" class="w-full px-4 py-3 border-2 border-gray-200 rounded-lg focus:border-primary focus:outline-none transition-colors"> <option value="proceso">Mejora de Proceso</option> <option value="normativa">Aspecto Normativo</option> <option value="tecnologia">Tecnolog√≠a/Sistemas</option> <option value="capacitacion">Capacitaci√≥n</option> <option value="otro">Otro</option> </select>
      </div>
      <div><label for="suggestion-text" class="block text-sm font-semibold text-gray-700 mb-2"> Tu sugerencia * </label> <textarea id="suggestion-text" rows="4" placeholder="Describe tu sugerencia para mejorar el procedimiento..." class="w-full px-4 py-3 border-2 border-gray-200 rounded-lg focus:border-primary focus:outline-none transition-colors resize-none" required></textarea>
      </div>
      <div class="flex gap-3"><button type="submit" class="flex-1 px-6 py-3 rounded-lg font-bold text-white transition-all hover:shadow-lg" style="background: linear-gradient(135deg, var(--color-primary), var(--color-medium));"> Enviar Sugerencia </button> <button type="button" id="cancel-btn" class="px-6 py-3 rounded-lg font-bold transition-all hover:bg-gray-100" style="color: var(--color-primary); border: 2px solid var(--color-primary);"> Cancelar </button>
      </div>
     </form><!-- Success Message -->
     <div id="success-message" class="hidden mt-4 p-4 rounded-lg flex items-center gap-3" style="background: linear-gradient(135deg, #10b981, #059669);">
      <svg class="w-6 h-6 text-white flex-shrink-0" fill="none" stroke="currentColor" stroke-width="2.5" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
      </svg>
      <p class="text-white font-semibold">¬°Gracias por tu sugerencia! Ha sido registrada correctamente.</p>
     </div><!-- Suggestions List -->
     <div id="suggestions-list-container" class="mt-6 hidden">
      <div class="flex items-center justify-between mb-4">
       <h4 class="text-lg font-bold" style="color: var(--color-primary);">Sugerencias Recibidas</h4><span id="suggestions-count" class="px-3 py-1 rounded-full text-sm font-bold text-white" style="background: var(--color-secondary); color: var(--color-primary);">0</span>
      </div>
      <div id="suggestions-list" class="space-y-3 max-h-64 overflow-y-auto"><!-- Suggestions will be added here -->
      </div>
     </div>
    </div>
   </div>
  </div>
  <script>
        const defaultConfig = {
            main_title: "PROCEDIMIENTO DE GESTI√ìN DE INVERSIONES PATRIMONIALES",
            subtitle: "INFIHUILA | Proceso: Gesti√≥n Financiera",
            code_label: "PI-XX",
            version_label: "01",
            validity_label: "2025",
            phases_title: "6 FASES CLAVE",
            objectives_title: "OBJETIVOS Y ALCANCE",
            primary_color: "#006C72",
            secondary_color: "#CCD400",
            medium_color: "#004651",
            background_color: "#f5f5f5",
            font_family: "Inter",
            font_size: 16
        };

        async function onConfigChange(config) {
            const customFont = config.font_family || defaultConfig.font_family;
            const baseFontStack = 'sans-serif';
            const fontFamily = `${customFont}, ${baseFontStack}`;
            const baseSize = config.font_size || defaultConfig.font_size;
            
            // Apply font family
            document.body.style.fontFamily = fontFamily;
            
            // Apply font sizes proportionally
            const mainTitle = document.getElementById('main-title');
            if (mainTitle) {
                mainTitle.style.fontSize = `${baseSize * 1.75}px`;
                mainTitle.style.fontWeight = 'bold';
            }
            
            const subtitle = document.getElementById('subtitle');
            if (subtitle) {
                subtitle.style.fontSize = `${baseSize * 1}px`;
                subtitle.style.fontWeight = 'bold';
            }
            
            // Update text content
            if (mainTitle) mainTitle.textContent = config.main_title || defaultConfig.main_title;
            if (subtitle) subtitle.textContent = config.subtitle || defaultConfig.subtitle;
            
            const codeValue = document.getElementById('code-value');
            if (codeValue) codeValue.textContent = config.code_label || defaultConfig.code_label;
            
            const versionValue = document.getElementById('version-value');
            if (versionValue) versionValue.textContent = config.version_label || defaultConfig.version_label;
            
            const validityValue = document.getElementById('validity-value');
            if (validityValue) validityValue.textContent = config.validity_label || defaultConfig.validity_label;
            
            const phasesTitle = document.getElementById('phases-title');
            if (phasesTitle) {
                phasesTitle.textContent = config.phases_title || defaultConfig.phases_title;
                phasesTitle.style.fontSize = `${baseSize * 1.25}px`;
                phasesTitle.style.fontWeight = 'bold';
            }
            
            const objectivesTitle = document.getElementById('objectives-title');
            if (objectivesTitle) {
                objectivesTitle.textContent = config.objectives_title || defaultConfig.objectives_title;
                objectivesTitle.style.fontSize = `${baseSize * 1.25}px`;
                objectivesTitle.style.fontWeight = 'bold';
            }
            
            // Apply colors
            const primaryColor = config.primary_color || defaultConfig.primary_color;
            const secondaryColor = config.secondary_color || defaultConfig.secondary_color;
            const mediumColor = config.medium_color || defaultConfig.medium_color;
            const backgroundColor = config.background_color || defaultConfig.background_color;
            
            document.documentElement.style.setProperty('--color-primary', primaryColor);
            document.documentElement.style.setProperty('--color-secondary', secondaryColor);
            document.documentElement.style.setProperty('--color-medium', mediumColor);
            document.documentElement.style.setProperty('--color-light', backgroundColor);
            
            document.body.style.backgroundColor = backgroundColor;
        }

        // Suggestions functionality
        const suggestionsBtn = document.getElementById('suggestions-btn');
        const suggestionsModal = document.getElementById('suggestions-modal');
        const closeModal = document.getElementById('close-modal');
        const cancelBtn = document.getElementById('cancel-btn');
        const suggestionForm = document.getElementById('suggestion-form');
        const successMessage = document.getElementById('success-message');
        const suggestionsListContainer = document.getElementById('suggestions-list-container');
        const suggestionsList = document.getElementById('suggestions-list');
        const suggestionsCount = document.getElementById('suggestions-count');
        
        let suggestions = [];

        function openModal() {
            suggestionsModal.classList.remove('hidden');
        }

        function closeModalFn() {
            suggestionsModal.classList.add('hidden');
            successMessage.classList.add('hidden');
            suggestionForm.reset();
        }

        function updateSuggestionsList() {
            suggestionsList.innerHTML = '';
            suggestionsCount.textContent = suggestions.length;
            
            if (suggestions.length > 0) {
                suggestionsListContainer.classList.remove('hidden');
                
                suggestions.forEach((suggestion, index) => {
                    const suggestionCard = document.createElement('div');
                    suggestionCard.className = 'p-4 rounded-lg border-2 border-gray-100 hover:border-primary transition-colors';
                    
                    const categoryColors = {
                        'proceso': '#006C72',
                        'normativa': '#CCD400',
                        'tecnologia': '#004651',
                        'capacitacion': '#10b981',
                        'otro': '#6b7280'
                    };
                    
                    const categoryNames = {
                        'proceso': 'Mejora de Proceso',
                        'normativa': 'Aspecto Normativo',
                        'tecnologia': 'Tecnolog√≠a/Sistemas',
                        'capacitacion': 'Capacitaci√≥n',
                        'otro': 'Otro'
                    };
                    
                    suggestionCard.innerHTML = `
                        <div class="flex items-start justify-between gap-3">
                            <div class="flex-1">
                                <div class="flex items-center gap-2 mb-2">
                                    <span class="px-2 py-1 rounded text-xs font-bold text-white" style="background: ${categoryColors[suggestion.category]};">
                                        ${categoryNames[suggestion.category]}
                                    </span>
                                    ${suggestion.name ? `<span class="text-xs text-gray-600">por ${suggestion.name}</span>` : ''}
                                </div>
                                <p class="text-sm text-gray-700">${suggestion.text}</p>
                                <p class="text-xs text-gray-500 mt-2">${suggestion.date}</p>
                            </div>
                        </div>
                    `;
                    
                    suggestionsList.appendChild(suggestionCard);
                });
            }
        }

        suggestionsBtn.addEventListener('click', openModal);
        closeModal.addEventListener('click', closeModalFn);
        cancelBtn.addEventListener('click', closeModalFn);
        
        suggestionsModal.addEventListener('click', (e) => {
            if (e.target === suggestionsModal) {
                closeModalFn();
            }
        });

        suggestionForm.addEventListener('submit', (e) => {
            e.preventDefault();
            
            const name = document.getElementById('user-name').value.trim();
            const category = document.getElementById('suggestion-category').value;
            const text = document.getElementById('suggestion-text').value.trim();
            
            if (text) {
                const now = new Date();
                const dateStr = now.toLocaleDateString('es-ES', { 
                    year: 'numeric', 
                    month: 'long', 
                    day: 'numeric', 
                    hour: '2-digit', 
                    minute: '2-digit' 
                });
                
                suggestions.unshift({
                    name: name || 'An√≥nimo',
                    category: category,
                    text: text,
                    date: dateStr
                });
                
                suggestionForm.reset();
                successMessage.classList.remove('hidden');
                updateSuggestionsList();
                
                setTimeout(() => {
                    successMessage.classList.add('hidden');
                }, 3000);
            }
        });

        // Investment Simulator Logic
        const calculateBtn = document.getElementById('calculate-btn');
        const resultsSection = document.getElementById('results-section');
        const headerPdfBtn = document.getElementById('header-pdf-btn');
        const mobilePdfBtn = document.getElementById('mobile-pdf-btn'); // Aunque lo quitamos visualmente en mobile, el c√≥digo puede permanecer seguro.

        // Function to handle PDF generation
        function generatePDF() {
            // Check if results exist (results section is visible)
            if (resultsSection.classList.contains('hidden')) {
                alert('‚ö†Ô∏è Por favor, realiza primero una simulaci√≥n de inversi√≥n para generar el reporte PDF con los resultados.');
                
                // Scroll to simulator
                document.getElementById('investment-value').scrollIntoView({ behavior: 'smooth', block: 'center' });
                return;
            }
            
            const element = document.getElementById('results-section');
            
            // Options for PDF generation
            const opt = {
                margin:       [15, 15, 20, 15], 
                filename:     'Reporte_Simulacion_INFIHUILA.pdf',
                image:        { type: 'jpeg', quality: 0.98 },
                html2canvas:  { scale: 2, useCORS: true, letterRendering: true },
                jsPDF:        { unit: 'mm', format: 'a4', orientation: 'portrait' },
                pagebreak:    { mode: ['avoid-all', 'css', 'legacy'] }
            };

            // Loading state
            const originalText = headerPdfBtn ? headerPdfBtn.innerHTML : '';
            if(headerPdfBtn) headerPdfBtn.innerHTML = 'Generando...';
            
            const now = new Date();
            const dateStr = now.toLocaleString('es-CO', { 
                year: 'numeric', 
                month: 'long', 
                day: 'numeric', 
                hour: '2-digit', 
                minute: '2-digit' 
            });

            html2pdf().from(element).set(opt).toPdf().get('pdf').then(function(pdf) {
                var totalPages = pdf.internal.getNumberOfPages();
                for (let i = 1; i <= totalPages; i++) {
                    pdf.setPage(i);
                    pdf.setFontSize(8);
                    pdf.setTextColor(100, 100, 100);
                    const footerTextLeft = `Generado el: ${dateStr}`;
                    const footerTextRight = `P√°gina ${i} de ${totalPages}`;
                    const pageSize = pdf.internal.pageSize;
                    const pageHeight = pageSize.height ? pageSize.height : pageSize.getHeight();
                    const pageWidth = pageSize.width ? pageSize.width : pageSize.getWidth();
                    pdf.text(footerTextLeft, 15, pageHeight - 10);
                    const textWidth = pdf.getStringUnitWidth(footerTextRight) * 8 / pdf.internal.scaleFactor;
                    pdf.text(footerTextRight, pageWidth - 15 - textWidth, pageHeight - 10);
                }
            }).save().then(() => {
                if(headerPdfBtn) headerPdfBtn.innerHTML = originalText;
            });
        }

        // Add listeners to both desktop and mobile buttons
        if(headerPdfBtn) headerPdfBtn.addEventListener('click', generatePDF);
        
        function formatCurrency(amount) {
            return new Intl.NumberFormat('es-CO', {
                style: 'currency',
                currency: 'COP',
                minimumFractionDigits: 0,
                maximumFractionDigits: 0
            }).format(amount);
        }

        function evaluateInvestment(returnRate, riskLevel) {
            // Define risk-return matrix criteria
            const matrix = {
                'bajo': {
                    'alta': { min: 7, category: 'buena', color: '#10b981' },
                    'media': { min: 4, max: 7, category: 'moderada', color: '#f59e0b' },
                    'baja': { max: 4, category: 'evaluar', color: '#ef4444' }
                },
                'medio': {
                    'alta': { min: 10, category: 'buena', color: '#10b981' },
                    'media': { min: 6, max: 10, category: 'moderada', color: '#f59e0b' },
                    'baja': { max: 6, category: 'no_recomendada', color: '#ef4444' }
                },
                'alto': {
                    'alta': { min: 15, category: 'evaluar', color: '#f59e0b' },
                    'media': { min: 10, max: 15, category: 'riesgosa', color: '#ef4444' },
                    'baja': { max: 10, category: 'rechazar', color: '#dc2626' }
                }
            };

            let rentabilityLevel;
            if (returnRate >= 12) rentabilityLevel = 'alta';
            else if (returnRate >= 6) rentabilityLevel = 'media';
            else rentabilityLevel = 'baja';

            const evaluation = matrix[riskLevel][rentabilityLevel];
            
            return {
                viable: evaluation.category === 'buena' || evaluation.category === 'moderada',
                category: evaluation.category,
                color: evaluation.color,
                rentabilityLevel: rentabilityLevel,
                riskLevel: riskLevel
            };
        }

        function getRecommendation(category, riskLevel, rentabilityLevel) {
            const recommendations = {
                'buena': {
                    title: '‚úÖ INVERSI√ìN VIABLE - RECOMENDADA',
                    description: 'Esta inversi√≥n presenta un equilibrio favorable entre riesgo y rentabilidad. Se recomienda proceder con la inversi√≥n siguiendo los protocolos establecidos.',
                    icon: '<svg class="w-10 h-10 text-white" fill="none" stroke="currentColor" stroke-width="2.5" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/></svg>',
                    borderColor: '#10b981'
                },
                'moderada': {
                    title: '‚ö†Ô∏è INVERSI√ìN MODERADA - REVISAR',
                    description: 'Esta inversi√≥n requiere an√°lisis adicional. Se recomienda evaluaci√≥n del Comit√© de Inversiones antes de proceder.',
                    icon: '<svg class="w-10 h-10 text-white" fill="none" stroke="currentColor" stroke-width="2.5" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"/></svg>',
                    borderColor: '#f59e0b'
                },
                'evaluar': {
                    title: '‚ö†Ô∏è REQUIERE EVALUACI√ìN DETALLADA',
                    description: 'La relaci√≥n riesgo-rentabilidad requiere an√°lisis exhaustivo. Se recomienda estudio t√©cnico completo y evaluaci√≥n de alternativas.',
                    icon: '<svg class="w-10 h-10 text-white" fill="none" stroke="currentColor" stroke-width="2.5" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/></svg>',
                    borderColor: '#f59e0b'
                },
                'riesgosa': {
                    title: '‚ùå INVERSI√ìN RIESGOSA',
                    description: 'Esta inversi√≥n presenta alto riesgo con rentabilidad insuficiente. NO se recomienda proceder sin mitigaci√≥n de riesgos significativa.',
                    icon: '<svg class="w-10 h-10 text-white" fill="none" stroke="currentColor" stroke-width="2.5" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12"/></svg>',
                    borderColor: '#ef4444'
                },
                'no_recomendada': {
                    title: '‚ùå NO RECOMENDADA',
                    description: 'Esta inversi√≥n no cumple con los criterios m√≠nimos de viabilidad. Se recomienda buscar alternativas de inversi√≥n m√°s adecuadas.',
                    icon: '<svg class="w-10 h-10 text-white" fill="none" stroke="currentColor" stroke-width="2.5" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12"/></svg>',
                    borderColor: '#ef4444'
                },
                'rechazar': {
                    title: 'üö´ RECHAZAR INVERSI√ìN',
                    description: 'Esta inversi√≥n presenta una relaci√≥n riesgo-rentabilidad desfavorable. Se RECHAZA la propuesta de inversi√≥n.',
                    icon: '<svg class="w-10 h-10 text-white" fill="none" stroke="currentColor" stroke-width="2.5" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M18.364 18.364A9 9 0 005.636 5.636m12.728 12.728A9 9 0 015.636 5.636m12.728 12.728L5.636 5.636"/></svg>',
                    borderColor: '#dc2626'
                }
            };

            return recommendations[category];
        }

        function getMatrixPositionText(riskLevel, rentabilityLevel, category) {
            const riskText = {
                'bajo': 'Bajo',
                'medio': 'Medio',
                'alto': 'Alto'
            };

            const rentabilityText = {
                'baja': 'Baja',
                'media': 'Media',
                'alta': 'Alta'
            };

            const categoryText = {
                'buena': 'BUENA - Proceder con inversi√≥n',
                'moderada': 'MODERADA - Requiere aprobaci√≥n del comit√©',
                'evaluar': 'EVALUAR - An√°lisis t√©cnico adicional necesario',
                'riesgosa': 'RIESGOSA - No recomendada',
                'no_recomendada': 'NO RECOMENDADA - Buscar alternativas',
                'rechazar': 'RECHAZAR - No viable'
            };

            return {
                position: `Riesgo ${riskText[riskLevel]} / Rentabilidad ${rentabilityText[rentabilityLevel]}`,
                category: categoryText[category]
            };
        }

        function drawPieChart(investmentValue, expectedReturn, evaluation) {
            const pieChart = document.getElementById('pie-chart');
            const pieLegend = document.getElementById('pie-legend');
            
            pieChart.innerHTML = '';
            pieLegend.innerHTML = '';
            
            const total = investmentValue + expectedReturn;
            const investmentPercent = (investmentValue / total) * 100;
            const returnPercent = (expectedReturn / total) * 100;
            
            const cx = 140;
            const cy = 140;
            const radius = 100;
            
            // Colores institucionales
            const primaryColor = getComputedStyle(document.documentElement).getPropertyValue('--color-primary').trim() || '#006C72';
            const secondaryColor = getComputedStyle(document.documentElement).getPropertyValue('--color-secondary').trim() || '#CCD400';
            
            // Calculate angles (starting from top, going clockwise)
            const investmentAngle = (investmentPercent / 100) * 360;
            const returnAngle = (returnPercent / 100) * 360;
            
            // Create path for investment (capital inicial) - Color primario
            const investmentPath = describeArc(cx, cy, radius, 0, investmentAngle);
            const investmentSlice = document.createElementNS('http://www.w3.org/2000/svg', 'path');
            investmentSlice.setAttribute('d', investmentPath);
            investmentSlice.setAttribute('fill', primaryColor);
            investmentSlice.setAttribute('stroke', 'white');
            investmentSlice.setAttribute('stroke-width', '2');
            investmentSlice.classList.add('pie-slice');
            investmentSlice.style.cursor = 'pointer';
            investmentSlice.style.transition = 'all 0.3s';
            
            // Create path for return (rendimiento) - Color secundario
            const returnPath = describeArc(cx, cy, radius, investmentAngle, investmentAngle + returnAngle);
            const returnSlice = document.createElementNS('http://www.w3.org/2000/svg', 'path');
            returnSlice.setAttribute('d', returnPath);
            returnSlice.setAttribute('fill', secondaryColor);
            returnSlice.setAttribute('stroke', 'white');
            returnSlice.setAttribute('stroke-width', '2');
            returnSlice.classList.add('pie-slice');
            returnSlice.style.cursor = 'pointer';
            returnSlice.style.transition = 'all 0.3s';
            
            // Add hover effects
            investmentSlice.addEventListener('mouseenter', function() {
                this.style.transform = 'scale(1.05)';
                this.style.transformOrigin = `${cx}px ${cy}px`;
            });
            investmentSlice.addEventListener('mouseleave', function() {
                this.style.transform = 'scale(1)';
            });
            
            returnSlice.addEventListener('mouseenter', function() {
                this.style.transform = 'scale(1.05)';
                this.style.transformOrigin = `${cx}px ${cy}px`;
            });
            returnSlice.addEventListener('mouseleave', function() {
                this.style.transform = 'scale(1)';
            });
            
            pieChart.appendChild(investmentSlice);
            pieChart.appendChild(returnSlice);
            
            // Add center circle for donut effect
            const centerCircle = document.createElementNS('http://www.w3.org/2000/svg', 'circle');
            centerCircle.setAttribute('cx', cx);
            centerCircle.setAttribute('cy', cy);
            centerCircle.setAttribute('r', '60');
            centerCircle.setAttribute('fill', 'white');
            pieChart.appendChild(centerCircle);
            
            // Add center text
            const centerText = document.createElementNS('http://www.w3.org/2000/svg', 'text');
            centerText.setAttribute('x', cx);
            centerText.setAttribute('y', cy - 10);
            centerText.setAttribute('text-anchor', 'middle');
            centerText.setAttribute('font-size', '18');
            centerText.setAttribute('font-weight', 'bold');
            centerText.setAttribute('fill', primaryColor);
            centerText.textContent = 'Total';
            pieChart.appendChild(centerText);
            
            const centerValue = document.createElementNS('http://www.w3.org/2000/svg', 'text');
            centerValue.setAttribute('x', cx);
            centerValue.setAttribute('y', cy + 15);
            centerValue.setAttribute('text-anchor', 'middle');
            centerValue.setAttribute('font-size', '14');
            centerValue.setAttribute('font-weight', 'bold');
            centerValue.setAttribute('fill', primaryColor);
            centerValue.textContent = formatCurrency(total);
            pieChart.appendChild(centerValue);
            
            // Create legend with institutional colors
            const legendItems = [
                { label: 'Capital Inicial', value: investmentValue, percent: investmentPercent, color: primaryColor },
                { label: 'Rendimiento Esperado', value: expectedReturn, percent: returnPercent, color: secondaryColor }
            ];
            
            legendItems.forEach(item => {
                const legendItem = document.createElement('div');
                legendItem.className = 'flex items-center justify-between p-3 bg-gray-50 rounded-lg hover:bg-gray-100 transition-colors';
                legendItem.innerHTML = `
                    <div class="flex items-center gap-2">
                        <div class="w-4 h-4 rounded" style="background: ${item.color};"></div>
                        <span class="font-semibold text-sm text-gray-700">${item.label}</span>
                    </div>
                    <div class="text-right">
                        <p class="font-bold text-sm" style="color: ${item.color};">${formatCurrency(item.value)}</p>
                        <p class="text-xs text-gray-500">${item.percent.toFixed(1)}%</p>
                    </div>
                `;
                pieLegend.appendChild(legendItem);
            });
        }
        
        function describeArc(x, y, radius, startAngle, endAngle) {
            const start = polarToCartesian(x, y, radius, endAngle);
            const end = polarToCartesian(x, y, radius, startAngle);
            const largeArcFlag = endAngle - startAngle <= 180 ? '0' : '1';
            
            const d = [
                'M', x, y,
                'L', start.x, start.y,
                'A', radius, radius, 0, largeArcFlag, 0, end.x, end.y,
                'Z'
            ].join(' ');
            
            return d;
        }
        
        function polarToCartesian(centerX, centerY, radius, angleInDegrees) {
            const angleInRadians = (angleInDegrees - 90) * Math.PI / 180.0;
            return {
                x: centerX + (radius * Math.cos(angleInRadians)),
                y: centerY + (radius * Math.sin(angleInRadians))
            };
        }

        // Bar Chart Function
        let currentInvestmentData = null;

        function drawBarChart(investmentValue, returnRate, years) {
            const barChart = document.getElementById('bar-chart');
            
            barChart.innerHTML = '';
            
            // Colores institucionales
            const primaryColor = getComputedStyle(document.documentElement).getPropertyValue('--color-primary').trim() || '#006C72';
            const secondaryColor = getComputedStyle(document.documentElement).getPropertyValue('--color-secondary').trim() || '#CCD400';
            const mediumColor = getComputedStyle(document.documentElement).getPropertyValue('--color-medium').trim() || '#004651';
            
            // Calculate yearly returns using EA formula
            const effectiveAnnualRate = returnRate / 100;
            const yearlyData = [];
            
            for (let year = 1; year <= years; year++) {
                const value = investmentValue * Math.pow(1 + effectiveAnnualRate, year);
                yearlyData.push({
                    year: year,
                    value: value,
                    return: value - investmentValue
                });
            }
            
            // Update summary panel
            const lastYearData = yearlyData[yearlyData.length - 1];
            document.getElementById('summary-capital').textContent = formatCurrency(investmentValue);
            document.getElementById('summary-returns').textContent = formatCurrency(lastYearData.return);
            document.getElementById('summary-total').textContent = formatCurrency(lastYearData.value);
            
            // Chart dimensions - responsive and contained
            const baseBarWidth = 50;
            const barSpacing = 15;
            const padding = { top: 30, right: 20, bottom: 70, left: 80 };
            
            // Calculate dynamic width based on years
            const calculatedWidth = (baseBarWidth + barSpacing) * years + padding.left + padding.right;
            const width = Math.max(500, calculatedWidth);
            const height = 350;
            
            const chartWidth = width - padding.left - padding.right;
            const chartHeight = height - padding.top - padding.bottom;
            
            // Set SVG width dynamically
            barChart.setAttribute('width', width);
            barChart.setAttribute('height', height);
            barChart.style.minWidth = width + 'px';
            
            // Find max value for scaling
            const maxValue = Math.max(...yearlyData.map(d => d.value));
            const yScale = chartHeight / maxValue;
            
            // Create background grid lines
            const gridLines = 5;
            for (let i = 0; i <= gridLines; i++) {
                const y = padding.top + (chartHeight / gridLines) * i;
                const gridValue = maxValue - (maxValue / gridLines) * i;
                
                // Horizontal grid line
                const line = document.createElementNS('http://www.w3.org/2000/svg', 'line');
                line.setAttribute('x1', padding.left);
                line.setAttribute('y1', y);
                line.setAttribute('x2', width - padding.right);
                line.setAttribute('y2', y);
                line.setAttribute('stroke', '#e5e7eb');
                line.setAttribute('stroke-width', '1');
                barChart.appendChild(line);
                
                // Y-axis label
                const label = document.createElementNS('http://www.w3.org/2000/svg', 'text');
                label.setAttribute('x', padding.left - 10);
                label.setAttribute('y', y + 4);
                label.setAttribute('text-anchor', 'end');
                label.setAttribute('font-size', '10');
                label.setAttribute('fill', '#6b7280');
                label.setAttribute('font-weight', '600');
                
                // Format currency more compactly
                const millions = gridValue / 1000000;
                if (millions >= 1) {
                    label.textContent = `$${millions.toFixed(0)}M`;
                } else {
                    const thousands = gridValue / 1000;
                    label.textContent = `$${thousands.toFixed(0)}K`;
                }
                barChart.appendChild(label);
            }
            
            // Draw bars
            const totalBarSpace = chartWidth / years;
            const barWidth = Math.min(baseBarWidth, totalBarSpace * 0.75);
            
            yearlyData.forEach((data, index) => {
                const barHeight = data.value * yScale;
                const x = padding.left + (totalBarSpace * index) + (totalBarSpace - barWidth) / 2;
                const y = padding.top + chartHeight - barHeight;
                
                // Bar rectangle - solid color (amarillo institucional)
                const bar = document.createElementNS('http://www.w3.org/2000/svg', 'rect');
                bar.setAttribute('x', x);
                bar.setAttribute('y', y);
                bar.setAttribute('width', barWidth);
                bar.setAttribute('height', barHeight);
                bar.setAttribute('fill', secondaryColor);
                bar.setAttribute('rx', '6');
                bar.style.cursor = 'pointer';
                bar.style.transition = 'all 0.3s';
                
                // Hover effects with tooltip
                const tooltip = document.createElementNS('http://www.w3.org/2000/svg', 'g');
                tooltip.setAttribute('class', 'bar-tooltip');
                tooltip.style.opacity = '0';
                tooltip.style.transition = 'opacity 0.3s';
                tooltip.style.pointerEvents = 'none';
                
                const tooltipBg = document.createElementNS('http://www.w3.org/2000/svg', 'rect');
                tooltipBg.setAttribute('x', x - 30);
                tooltipBg.setAttribute('y', y - 45);
                tooltipBg.setAttribute('width', barWidth + 60);
                tooltipBg.setAttribute('height', '35');
                tooltipBg.setAttribute('fill', mediumColor);
                tooltipBg.setAttribute('rx', '6');
                
                const tooltipText = document.createElementNS('http://www.w3.org/2000/svg', 'text');
                tooltipText.setAttribute('x', x + barWidth / 2);
                tooltipText.setAttribute('y', y - 24);
                tooltipText.setAttribute('text-anchor', 'middle');
                tooltipText.setAttribute('font-size', '11');
                tooltipText.setAttribute('font-weight', 'bold');
                tooltipText.setAttribute('fill', 'white');
                tooltipText.textContent = formatCurrency(data.value);
                
                tooltip.appendChild(tooltipBg);
                tooltip.appendChild(tooltipText);
                barChart.appendChild(tooltip);
                
                bar.addEventListener('mouseenter', function() {
                    this.style.opacity = '0.8';
                    tooltip.style.opacity = '1';
                });
                
                bar.addEventListener('mouseleave', function() {
                    this.style.opacity = '1';
                    tooltip.style.opacity = '0';
                });
                
                barChart.appendChild(bar);
                
                // X-axis label (year)
                const xLabel = document.createElementNS('http://www.w3.org/2000/svg', 'text');
                xLabel.setAttribute('x', x + barWidth / 2);
                xLabel.setAttribute('y', height - padding.bottom + 20);
                xLabel.setAttribute('text-anchor', 'middle');
                xLabel.setAttribute('font-size', '11');
                xLabel.setAttribute('font-weight', 'bold');
                xLabel.setAttribute('fill', primaryColor);
                xLabel.textContent = `A√±o ${data.year}`;
                barChart.appendChild(xLabel);
            });
            
            // Y-axis title
            const yAxisTitle = document.createElementNS('http://www.w3.org/2000/svg', 'text');
            yAxisTitle.setAttribute('x', 15);
            yAxisTitle.setAttribute('y', height / 2);
            yAxisTitle.setAttribute('text-anchor', 'middle');
            yAxisTitle.setAttribute('font-size', '11');
            yAxisTitle.setAttribute('font-weight', 'bold');
            yAxisTitle.setAttribute('fill', mediumColor);
            yAxisTitle.setAttribute('transform', `rotate(-90, 15, ${height / 2})`);
            yAxisTitle.textContent = 'Valor Total';
            barChart.appendChild(yAxisTitle);
        }

        // Years selector event listener
        const yearsSelector = document.getElementById('years-selector');
        const yearsDisplay = document.getElementById('years-display');
        
        yearsSelector.addEventListener('input', (e) => {
            const years = parseInt(e.target.value);
            yearsDisplay.textContent = `${years} a√±o${years > 1 ? 's' : ''}`;
            
            if (currentInvestmentData) {
                drawBarChart(
                    currentInvestmentData.investmentValue,
                    currentInvestmentData.returnRate,
                    years
                );
            }
        });

        calculateBtn.addEventListener('click', () => {
            const investmentValue = parseFloat(document.getElementById('investment-value').value);
            const timePeriod = parseInt(document.getElementById('time-period').value);
            const returnRate = parseFloat(document.getElementById('return-rate').value);
            const riskLevel = document.getElementById('risk-level').value;

            // Validate inputs
            if (!investmentValue || investmentValue < 1000000) {
                const tempMsg = document.createElement('div');
                tempMsg.className = 'fixed top-4 right-4 bg-red-500 text-white px-6 py-3 rounded-lg shadow-lg z-50';
                tempMsg.textContent = 'Por favor ingresa un valor de inversi√≥n v√°lido (m√≠nimo $1,000,000)';
                document.body.appendChild(tempMsg);
                setTimeout(() => tempMsg.remove(), 3000);
                return;
            }

            if (!timePeriod || timePeriod < 1 || timePeriod > 360) {
                const tempMsg = document.createElement('div');
                tempMsg.className = 'fixed top-4 right-4 bg-red-500 text-white px-6 py-3 rounded-lg shadow-lg z-50';
                tempMsg.textContent = 'Por favor ingresa un tiempo v√°lido (1-360 meses)';
                document.body.appendChild(tempMsg);
                setTimeout(() => tempMsg.remove(), 3000);
                return;
            }

            // Calculate returns using Effective Annual Rate (EA)
            // Formula: VF = VP * (1 + i)^n where i is EA and n is in years
            const effectiveAnnualRate = returnRate / 100;
            const years = timePeriod / 12;
            const finalValue = investmentValue * Math.pow(1 + effectiveAnnualRate, years);
            const expectedReturn = finalValue - investmentValue;
            const roiPercentage = ((finalValue - investmentValue) / investmentValue * 100).toFixed(2);

            // Evaluate investment
            const evaluation = evaluateInvestment(returnRate, riskLevel);
            const recommendation = getRecommendation(evaluation.category, riskLevel, evaluation.rentabilityLevel);
            const matrixPosition = getMatrixPositionText(riskLevel, evaluation.rentabilityLevel, evaluation.category);

            // Update results
            document.getElementById('result-initial').textContent = formatCurrency(investmentValue);
            document.getElementById('result-return').textContent = formatCurrency(expectedReturn);
            document.getElementById('result-final').textContent = formatCurrency(finalValue);
            document.getElementById('result-roi').textContent = `${roiPercentage}%`;
            document.getElementById('result-time').textContent = `${timePeriod} meses (${(timePeriod / 12).toFixed(1)} a√±os)`;

            // Update viability card
            const viabilityCard = document.getElementById('viability-card');
            viabilityCard.style.borderColor = recommendation.borderColor;
            viabilityCard.style.background = `linear-gradient(135deg, ${evaluation.color}15, ${evaluation.color}05)`;

            const viabilityIcon = document.getElementById('viability-icon');
            viabilityIcon.style.background = evaluation.color;
            viabilityIcon.innerHTML = recommendation.icon;

            document.getElementById('viability-title').textContent = recommendation.title;
            document.getElementById('viability-title').style.color = evaluation.color;
            document.getElementById('viability-category').textContent = `Categor√≠a: ${evaluation.category.toUpperCase().replace('_', ' ')}`;
            document.getElementById('viability-category').style.color = evaluation.color;
            document.getElementById('viability-description').textContent = recommendation.description;

            // Update matrix position
            const matrixPositionDiv = document.getElementById('matrix-position');
            matrixPositionDiv.style.background = `linear-gradient(135deg, ${evaluation.color}20, ${evaluation.color}10)`;
            matrixPositionDiv.style.border = `3px solid ${evaluation.color}`;
            document.getElementById('matrix-text').textContent = matrixPosition.position;
            document.getElementById('matrix-text').style.color = evaluation.color;
            document.getElementById('matrix-recommendation').textContent = matrixPosition.category;

            // Draw interactive pie chart
            drawPieChart(investmentValue, expectedReturn, evaluation);

            // Store current data for bar chart updates
            currentInvestmentData = {
                investmentValue: investmentValue,
                returnRate: returnRate
            };

            // Draw bar chart with current years setting
            const currentYears = parseInt(yearsSelector.value);
            drawBarChart(investmentValue, returnRate, currentYears);

            // Show results
            resultsSection.classList.remove('hidden');
            resultsSection.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
        });

        // Roles Interactivity - Initialize immediately
        const roleData = {
            gerente: {
                title: "Gerente",
                color: "linear-gradient(135deg, var(--color-primary), var(--color-medium))",
                responsibilities: [
                    "Presidir el Comit√© de Inversiones y dirigir las sesiones",
                    "Aprobar la pol√≠tica general de inversiones institucionales",
                    "Autorizar inversiones seg√∫n montos y facultades establecidas",
                    "Tomar decisiones estrat√©gicas sobre el portafolio",
                    "Supervisar el cumplimiento de objetivos financieros institucionales"
                ]
            },
            jefatura_financiera: {
                title: "Jefatura Financiera",
                color: "linear-gradient(135deg, var(--color-primary), var(--color-medium))",
                responsibilities: [
                    "Presentar an√°lisis t√©cnico-financiero de las propuestas de inversi√≥n",
                    "Gestionar la ejecuci√≥n operativa del portafolio de inversiones",
                    "Coordinar con entidades financieras y emisores de t√≠tulos valores",
                    "Elaborar reportes de rendimiento y seguimiento del portafolio",
                    "Garantizar la disponibilidad presupuestal y registro contable de inversiones"
                ]
            },
            asesor_juridico: {
                title: "Asesor Jur√≠dico",
                color: "linear-gradient(135deg, var(--color-secondary), #b8c000)",
                responsibilities: [
                    "Revisar y validar aspectos legales de contratos de inversi√≥n",
                    "Verificar cumplimiento de normativa y regulaciones aplicables",
                    "Asesorar al Comit√© sobre cambios regulatorios relevantes",
                    "Validar poderes, autorizaciones y documentaci√≥n legal requerida",
                    "Gestionar aspectos jur√≠dicos ante entidades de vigilancia y control"
                ]
            },
            jefe_comercial: {
                title: "Jefe Comercial",
                color: "linear-gradient(135deg, var(--color-medium), var(--color-primary))",
                responsibilities: [
                    "Evaluar el impacto comercial de las decisiones de inversi√≥n",
                    "Aportar perspectiva del mercado y relaciones institucionales",
                    "Analizar oportunidades de inversi√≥n vinculadas a estrategia comercial",
                    "Coordinar con √°reas comerciales la ejecuci√≥n de inversiones",
                    "Participar en la evaluaci√≥n de riesgo-rentabilidad de propuestas"
                ]
            },
            oficina_riesgos: {
                title: "Oficina de Riesgos",
                color: "linear-gradient(135deg, var(--color-secondary), #b8c000)",
                responsibilities: [
                    "Evaluar y cuantificar riesgos financieros de cada inversi√≥n propuesta",
                    "Establecer l√≠mites de exposici√≥n y concentraci√≥n del portafolio",
                    "Monitorear el perfil riesgo-rentabilidad de las inversiones vigentes",
                    "Emitir alertas tempranas sobre desviaciones o riesgos emergentes",
                    "Recomendar estrategias de mitigaci√≥n y diversificaci√≥n de riesgos"
                ]
            }
        };

        let activeRole = null;
        
        // Attach click handlers directly to each role card
        function attachRoleHandlers() {
            const roleCards = document.querySelectorAll('.role-card');
            const roleDetailsPanel = document.getElementById('role-details');
            const roleDetailsContent = document.getElementById('role-details-content');
            
            console.log('Found role cards:', roleCards.length);
            
            roleCards.forEach(card => {
                card.addEventListener('click', function(e) {
                    e.preventDefault();
                    e.stopPropagation();
                    
                    const role = this.getAttribute('data-role');
                    console.log('Clicked role:', role);
                    
                    if (!role || !roleData[role]) {
                        console.error('Role not found:', role);
                        return;
                    }
                    
                    // Toggle if clicking the same role
                    if (activeRole === role) {
                        roleDetailsPanel.classList.add('hidden');
                        activeRole = null;
                        roleCards.forEach(c => {
                            c.style.transform = '';
                            c.style.boxShadow = '';
                        });
                        return;
                    }
                    
                    activeRole = role;
                    const data = roleData[role];
                    
                    // Update active state
                    roleCards.forEach(c => {
                        c.style.transform = '';
                        c.style.boxShadow = '';
                    });
                    this.style.transform = 'scale(1.05)';
                    this.style.boxShadow = '0 10px 25px rgba(0, 0, 0, 0.2)';
                    
                    // Build content
                    const primaryColor = getComputedStyle(document.documentElement).getPropertyValue('--color-primary').trim() || '#006C72';
                    const secondaryColor = getComputedStyle(document.documentElement).getPropertyValue('--color-secondary').trim() || '#CCD400';
                    
                    roleDetailsContent.style.borderColor = primaryColor;
                    roleDetailsContent.innerHTML = `
                        <div class="flex items-center gap-3 mb-4 pb-3 border-b-2" style="border-color: ${secondaryColor}">
                            <div class="w-12 h-12 rounded-full flex items-center justify-center" style="background: ${data.color}">
                                <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" stroke-width="2.5" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/>
                                </svg>
                            </div>
                            <div>
                                <h4 class="text-lg font-bold" style="color: ${primaryColor}">${data.title}</h4>
                                <p class="text-xs text-gray-600">Miembro del Comit√© de Inversiones</p>
                            </div>
                        </div>
                        <div class="space-y-2">
                            ${data.responsibilities.map((resp, index) => `
                                <div class="flex items-start gap-3 p-3 bg-white rounded-lg hover:shadow-md transition-shadow">
                                    <div class="w-6 h-6 rounded-full flex items-center justify-center flex-shrink-0 mt-0.5" style="background: ${secondaryColor}">
                                        <span class="text-xs font-bold" style="color: ${primaryColor}">${index + 1}</span>
                                    </div>
                                    <p class="text-sm text-gray-700 leading-relaxed">${resp}</p>
                                </div>
                            `).join('')}
                        </div>
                    `;
                    
                    roleDetailsPanel.classList.remove('hidden');
                    
                    setTimeout(() => {
                        roleDetailsPanel.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
                    }, 100);
                });
            });
        }
        
        // Run immediately
        attachRoleHandlers();

        if (window.elementSdk) {
            window.elementSdk.init({
                defaultConfig,
                onConfigChange,
                mapToCapabilities: (config) => ({
                    recolorables: [
                        {
                            get: () => config.primary_color || defaultConfig.primary_color,
                            set: (value) => {
                                config.primary_color = value;
                                window.elementSdk.setConfig({ primary_color: value });
                            }
                        },
                        {
                            get: () => config.secondary_color || defaultConfig.secondary_color,
                            set: (value) => {
                                config.secondary_color = value;
                                window.elementSdk.setConfig({ secondary_color: value });
                            }
                        },
                        {
                            get: () => config.medium_color || defaultConfig.medium_color,
                            set: (value) => {
                                config.medium_color = value;
                                window.elementSdk.setConfig({ medium_color: value });
                            }
                        },
                        {
                            get: () => config.background_color || defaultConfig.background_color,
                            set: (value) => {
                                config.background_color = value;
                                window.elementSdk.setConfig({ background_color: value });
                            }
                        }
                    ],
                    borderables: [],
                    fontEditable: {
                        get: () => config.font_family || defaultConfig.font_family,
                        set: (value) => {
                            config.font_family = value;
                            window.elementSdk.setConfig({ font_family: value });
                        }
                    },
                    fontSizeable: {
                        get: () => config.font_size || defaultConfig.font_size,
                        set: (value) => {
                            config.font_size = value;
                            window.elementSdk.setConfig({ font_size: value });
                        }
                    }
                }),
                mapToEditPanelValues: (config) => new Map([
                    ["main_title", config.main_title || defaultConfig.main_title],
                    ["subtitle", config.subtitle || defaultConfig.subtitle],
                    ["code_label", config.code_label || defaultConfig.code_label],
                    ["version_label", config.version_label || defaultConfig.version_label],
                    ["validity_label", config.validity_label || defaultConfig.validity_label],
                    ["phases_title", config.phases_title || defaultConfig.phases_title],
                    ["objectives_title", config.objectives_title || defaultConfig.objectives_title]
                ])
            });
        }
    </script>
 </body>
</html>